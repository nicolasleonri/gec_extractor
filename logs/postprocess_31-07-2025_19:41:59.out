
Loading Image list...
Found 45 images in ./results/images/preprocessed
Starting multithreaded LLM postprocessing...
Models to process: ['olmocr']

============================================================
Starting multithreaded processing for model: olmocr
Total OCR results to process: 90
Total Images to process: 45
Using 64 worker threads
============================================================
Loading allenai/olmOCR-7B-0225-preview
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  9.77it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 26.65it/s]
You have video processor config saved in `preprocessor.json` file which is deprecated. Video processor configs should be saved in their own `video_preprocessor.json` file. You can rename the file or load and save the processor back which renames it automatically. Loading from `preprocessor.json` will be removed in v5.0.
Successfully loaded allenai/olmOCR-7B-0225-preview
The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
VLM detected, logging to OCR log.
✓ Progress: 1/45 (2.2%) - Processed ./results/images/preprocessed/trome#2020-03-13#04_config18.tiff with olmocr in 53.12s
The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
VLM detected, logging to OCR log.
✓ Progress: 2/45 (4.4%) - Processed ./results/images/preprocessed/trome#2020-03-13#04_config37.tiff with olmocr in 70.41s
The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
VLM detected, logging to OCR log.
✓ Progress: 3/45 (6.7%) - Processed ./results/images/preprocessed/trome#2020-03-13#04_config10.tiff with olmocr in 119.85s
The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Traceback (most recent call last):
  File "/data/gec_extractor/src/postprocess/postprocess.py", line 753, in process_model_multithreaded
    for future in as_completed(futures):
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/gec_extractor/src/postprocess/postprocess.py", line 948, in <module>
    main()
  File "/data/gec_extractor/src/postprocess/postprocess.py", line 922, in main
    model_results = process_model_multithreaded(
  File "/data/gec_extractor/src/postprocess/postprocess.py", line 730, in process_model_multithreaded
    with ThreadPoolExecutor(max_workers=max_workers) as executor:
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 649, in __exit__
    self.shutdown(wait=True)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/usr/lib/python3.10/threading.py'>
Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1537, in _shutdown
    atexit_call()
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 31, in _python_exit
    t.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt: 
terminate called without an active exception
Traceback (most recent call last):
  File "/data/gec_extractor/src/postprocess/postprocess.py", line 16, in <module>
    from qwen_vl_utils import process_vision_info
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/qwen_vl_utils/__init__.py", line 1, in <module>
    from .vision_process import (
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/qwen_vl_utils/vision_process.py", line 15, in <module>
    import requests
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/requests/__init__.py", line 164, in <module>
    from .api import delete, get, head, options, patch, post, put, request
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/requests/api.py", line 11, in <module>
    from . import sessions
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/requests/sessions.py", line 15, in <module>
    from .adapters import HTTPAdapter
  File "/data/gec_extractor/venv/postprocess/lib/python3.10/site-packages/requests/adapters.py", line 81, in <module>
    _preloaded_ssl_context.load_verify_locations(
KeyboardInterrupt
