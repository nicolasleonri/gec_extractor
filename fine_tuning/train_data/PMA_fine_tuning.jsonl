{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all school names in alphabetical order."}, {"role": "assistant", "content": "SELECT school_name FROM school ORDER BY school_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the ships that are not involved in any missions?"}, {"role": "assistant", "content": "SELECT Name FROM ship WHERE Ship_ID NOT IN (SELECT Ship_ID FROM mission)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show id, first and last names for all customers with at least two cards."}, {"role": "assistant", "content": "SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name FROM Customers_cards AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many users are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM user_profiles"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many players were in the team Boston Red Stockings in 2000?"}, {"role": "assistant", "content": "SELECT count(*) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings' AND T1.year  =  2000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the pair of male and female names in all weddings after year 2014"}, {"role": "assistant", "content": "SELECT T2.name ,  T3.name FROM wedding AS T1 JOIN people AS T2 ON T1.male_id  =  T2.people_id JOIN people AS T3 ON T1.female_id  =  T3.people_id WHERE T1.year  >  2014"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names, checking balances, and savings balances for all customers?"}, {"role": "assistant", "content": "SELECT T2.balance ,  T3.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the dates of performances with attending members whose roles are \"Violin\"."}, {"role": "assistant", "content": "SELECT T3.Date FROM member_attendance AS T1 JOIN member AS T2 ON T1.Member_ID  =  T2.Member_ID JOIN performance AS T3 ON T1.Performance_ID  =  T3.Performance_ID WHERE T2.Role  =  \"Violin\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average number of audience for festivals?"}, {"role": "assistant", "content": "SELECT avg(Num_of_Audience) FROM festival_detail"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many faculty members do we have for each faculty rank?"}, {"role": "assistant", "content": "SELECT rank ,  count(*) FROM Faculty GROUP BY rank"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different album labels listed?"}, {"role": "assistant", "content": "SELECT DISTINCT label FROM Albums"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id of the candidate with the lowest oppose rate?"}, {"role": "assistant", "content": "SELECT Candidate_ID FROM candidate ORDER BY oppose_rate LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first and last names of all students who are not living in the city HKG and order the results by age?"}, {"role": "assistant", "content": "SELECT fname ,  lname FROM student WHERE city_code != 'HKG' ORDER BY age"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all races that occurred after 12:00:00 or before 09:00:00?"}, {"role": "assistant", "content": "SELECT name FROM races WHERE TIME > \"12:00:00\" OR TIME < \"09:00:00\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the distinct names of wines produced before the year of 2000 or after the year of 2010."}, {"role": "assistant", "content": "SELECT DISTINCT Name FROM WINE WHERE YEAR  <  2000 OR YEAR  >  2010"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of documents that contain the substring \"CV\"?"}, {"role": "assistant", "content": "SELECT document_name FROM documents WHERE document_name LIKE \"%CV%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all info about all people."}, {"role": "assistant", "content": "SELECT * FROM people"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the storm that affected both Afghanistan and Albania regions."}, {"role": "assistant", "content": "SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Afghanistan' INTERSECT SELECT T3.Name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id WHERE T2.Region_name  =  'Albania'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the maximum and minimum height of all players?"}, {"role": "assistant", "content": "SELECT max(weight) ,  min(weight) FROM Player"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List every album whose title starts with A in alphabetical order."}, {"role": "assistant", "content": "SELECT title FROM albums WHERE title LIKE 'A%' ORDER BY title;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name of students not enrolled in any course."}, {"role": "assistant", "content": "SELECT Fname FROM STUDENT WHERE StuID NOT IN (SELECT StuID FROM ENROLLED_IN)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many phones are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM phone"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "A list of the top 10 countries by average invoice size. List country name and average invoice size."}, {"role": "assistant", "content": "SELECT billing_country ,  AVG(total) FROM invoices GROUP BY billing_country ORDER BY AVG(total) DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of funiture types produced by each manufacturer as well as the company names."}, {"role": "assistant", "content": "SELECT count(*) ,  t1.name FROM manufacturer AS t1 JOIN furniture_manufacte AS t2 ON t1.manufacturer_id  =  t2.manufacturer_id GROUP BY t1.manufacturer_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the building that the instructor who teaches the greatest number of courses lives in."}, {"role": "assistant", "content": "SELECT T2.Building FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the city with the smallest GDP? Return the city and its GDP."}, {"role": "assistant", "content": "SELECT city ,  GDP FROM city ORDER BY GDP LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the customer who has greatest total loan amount?"}, {"role": "assistant", "content": "SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total home game attendance of team Boston Red Stockings from 2000 to 2010?"}, {"role": "assistant", "content": "SELECT sum(T1.attendance) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year BETWEEN 2000 AND 2010;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Select all the data from the products and each product's manufacturer."}, {"role": "assistant", "content": "SELECT * FROM products AS T1 JOIN Manufacturers AS T2 ON T1.manufacturer  =  T2.code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each product, return its id and the number of times it was ordered."}, {"role": "assistant", "content": "SELECT count(*) ,  T3.product_id FROM orders AS T1 JOIN order_items AS T2 JOIN products AS T3 ON T1.order_id = T2.order_id AND T2.product_id = T3.product_id GROUP BY T3.product_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many exhibitions have a attendance more than 100 or have a ticket price below 10?"}, {"role": "assistant", "content": "SELECT count(*) FROM exhibition_record AS T1 JOIN exhibition AS T2 ON T1.exhibition_id  =  T2.exhibition_id WHERE T1.attendance  >  100 OR T2.ticket_price  <  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of products for each manufacturer, showing the name of each company."}, {"role": "assistant", "content": "SELECT count(*) ,  T2.name FROM products AS T1 JOIN manufacturers AS T2 ON T1.Manufacturer  =  T2.code GROUP BY T2.name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the number of trains"}, {"role": "assistant", "content": "SELECT count(*) FROM train"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the full name of the customer who made the first rental."}, {"role": "assistant", "content": "SELECT T1.first_name ,  T1.last_name FROM customer AS T1 JOIN rental AS T2 ON T1.customer_id  =  T2.customer_id ORDER BY T2.rental_date ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the allergies the girl named Lisa has? And what are the types of them? Order the result by allergy names."}, {"role": "assistant", "content": "SELECT T1.Allergy ,  T1.AllergyType FROM Allergy_type AS T1 JOIN Has_allergy AS T2 ON T1.Allergy  =  T2.Allergy JOIN Student AS T3 ON T3.StuID  =  T2.StuID WHERE T3.Fname  =  \"Lisa\" ORDER BY T1.Allergy"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all female candidates in alphabetical order (sex is F)?"}, {"role": "assistant", "content": "SELECT t1.name FROM people AS t1 JOIN candidate AS t2 ON t1.people_id  =  t2.people_id WHERE t1.sex  =  'F' ORDER BY t1.name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the customers who use the most frequently used payment method."}, {"role": "assistant", "content": "SELECT customer_name FROM customers WHERE payment_method  =  (SELECT payment_method FROM customers GROUP BY payment_method ORDER BY count(*) DESC LIMIT 1)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the number of customers that did not have any payment history."}, {"role": "assistant", "content": "SELECT count(*) FROM Customers WHERE customer_id NOT IN ( SELECT customer_id FROM Customer_Payments );"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which papers have \"Stephanie Weirich\" as an author?"}, {"role": "assistant", "content": "SELECT t3.title FROM authors AS t1 JOIN authorship AS t2 ON t1.authid  =  t2.authid JOIN papers AS t3 ON t2.paperid  =  t3.paperid WHERE t1.fname  =  \"Stephanie\" AND t1.lname  =  \"Weirich\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the famous title of the artists associated with volumes with more than 2 weeks on top?"}, {"role": "assistant", "content": "SELECT T1.Famous_Title FROM artist AS T1 JOIN volume AS T2 ON T1.Artist_ID  =  T2.Artist_ID WHERE T2.Weeks_on_Top  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the ids and names of members who are under age 30 or with black membership card."}, {"role": "assistant", "content": "SELECT name ,  member_id FROM member WHERE Membership_card  =  'Black' OR age  <  30"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the minimum, average and maximum distances traveled across all aircrafts."}, {"role": "assistant", "content": "SELECT min(distance) ,  avg(distance) ,  max(distance) FROM Aircraft"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the team name and acc regular season score of the school that was founded for the longest time?"}, {"role": "assistant", "content": "SELECT t2.team_name ,  t2.ACC_Regular_Season FROM university AS t1 JOIN basketball_match AS t2 ON t1.school_id  =  t2.school_id ORDER BY t1.founded LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the different statuses of cities, ascending by frequency."}, {"role": "assistant", "content": "SELECT Status FROM city GROUP BY Status ORDER BY COUNT(*) ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all 200 meter and 300 meter results of swimmers with nationality \"Australia\"."}, {"role": "assistant", "content": "SELECT meter_200 ,  meter_300 FROM swimmer WHERE nationality  =  'Australia'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different nationalities of pilots? Show each nationality and the number of pilots of each nationality."}, {"role": "assistant", "content": "SELECT Nationality ,  COUNT(*) FROM pilot GROUP BY Nationality"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the themes of farm competitions, sorted by year ascending."}, {"role": "assistant", "content": "SELECT Theme FROM farm_competition ORDER BY YEAR ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the distinct director of all films."}, {"role": "assistant", "content": "SELECT DISTINCT Director FROM film"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the forename and surname of the driver who has the smallest laptime?"}, {"role": "assistant", "content": "SELECT T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid ORDER BY T2.milliseconds LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of rooms that do not have any reservation."}, {"role": "assistant", "content": "SELECT count(*) FROM rooms WHERE roomid NOT IN (SELECT DISTINCT room FROM reservations)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and email of the users who have more than 1000 followers."}, {"role": "assistant", "content": "SELECT name ,  email FROM user_profiles WHERE followers  >  1000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of voting records in total."}, {"role": "assistant", "content": "SELECT count(*) FROM VOTING_RECORD"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the description of the transaction type that occurs most frequently."}, {"role": "assistant", "content": "SELECT T1.transaction_type_description FROM Ref_Transaction_Types AS T1 JOIN TRANSACTIONS AS T2 ON T1.transaction_type_code  =  T2.transaction_type_code GROUP BY T1.transaction_type_code ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last name and age of the student who has allergy to both milk and cat."}, {"role": "assistant", "content": "SELECT lname ,  age FROM Student WHERE StuID IN (SELECT StuID FROM Has_allergy WHERE Allergy  =  \"Milk\" INTERSECT SELECT StuID FROM Has_allergy WHERE Allergy  =  \"Cat\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the full names of all students"}, {"role": "assistant", "content": "SELECT Fname ,  Lname FROM Student"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total balance of savings accounts not belonging to someone with the name Brown?"}, {"role": "assistant", "content": "SELECT sum(T2.balance) FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T1.name != 'Brown'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the id, the date of account opened, the account name, and other account detail for all accounts."}, {"role": "assistant", "content": "SELECT account_id ,  date_account_opened ,  account_name ,  other_account_details FROM Accounts"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average cost of procedures that physician John Wen was trained in?"}, {"role": "assistant", "content": "SELECT avg(T3.cost) FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  \"John Wen\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the employee ids for employees who make more than the average?"}, {"role": "assistant", "content": "SELECT employee_id FROM employees WHERE salary  >  (SELECT AVG(salary) FROM employees)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the teams with the most technicians?"}, {"role": "assistant", "content": "SELECT Team FROM technician GROUP BY Team ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of the students who attended courses in the statistics department in order of attendance date."}, {"role": "assistant", "content": "SELECT T2.student_id FROM courses AS T1 JOIN student_course_attendance AS T2 ON T1.course_id = T2.course_id WHERE T1.course_name = \"statistics\" ORDER BY T2.date_of_attendance"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of companies whose industry is \"Banking\" or \"Conglomerate\","}, {"role": "assistant", "content": "SELECT count(*) FROM Companies WHERE Industry  =  \"Banking\" OR Industry  =  \"Conglomerate\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the name of buildings that do not have any institution."}, {"role": "assistant", "content": "SELECT name FROM building WHERE building_id NOT IN (SELECT building_id FROM institution)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and location of the wrestlers?"}, {"role": "assistant", "content": "SELECT Name ,  LOCATION FROM wrestler"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the average price of hotels for each star rating code."}, {"role": "assistant", "content": "SELECT star_rating_code ,  avg(price_range) FROM HOTELS GROUP BY star_rating_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the team that attended the least number of home games in 1980."}, {"role": "assistant", "content": "SELECT T2.name FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T1.year = 1980 ORDER BY T1.attendance ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which customer's name contains \"Alex\"? Find the full name."}, {"role": "assistant", "content": "SELECT customer_name FROM customers WHERE customer_name LIKE \"%Alex%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all product names without an order."}, {"role": "assistant", "content": "SELECT product_name FROM Products EXCEPT SELECT T1.product_name FROM Products AS T1 JOIN Order_items AS T2 ON T1.product_id  =  T2.product_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different songs have shared vocals?"}, {"role": "assistant", "content": "SELECT count(DISTINCT title) FROM vocals AS T1 JOIN songs AS T2 ON T1.songid  =  T2.songid WHERE TYPE  =  \"shared\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which role is most common for the staff?"}, {"role": "assistant", "content": "SELECT role_code FROM Project_Staff GROUP BY role_code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of customer cards of the type Debit."}, {"role": "assistant", "content": "SELECT count(*) FROM Customers_cards WHERE card_type_code  =  \"Debit\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the locations of schools in ascending order of enrollment."}, {"role": "assistant", "content": "SELECT LOCATION FROM school ORDER BY Enrollment ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "which pilot is in charge of the most number of flights?"}, {"role": "assistant", "content": "SELECT pilot FROM flight GROUP BY pilot ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the type of vocals that the band member with the last name \"Heilo\" played the most?"}, {"role": "assistant", "content": "SELECT TYPE FROM vocals AS T1 JOIN band AS T2 ON T1.bandmate  =  T2.id WHERE lastname  =  \"Heilo\" GROUP BY TYPE ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all director names who have a movie in the year 1999 or 2000."}, {"role": "assistant", "content": "SELECT director FROM movie WHERE YEAR  =  1999 OR YEAR  =  2000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which country has at most 3 stadiums listed?"}, {"role": "assistant", "content": "SELECT country FROM stadium GROUP BY country HAVING count(*)  <=  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the details of the lots which are not used in any transactions?"}, {"role": "assistant", "content": "SELECT lot_details FROM Lots EXCEPT SELECT T1.lot_details FROM Lots AS T1 JOIN transactions_lots AS T2 ON T1.lot_id  =  T2.lot_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "how many programs are broadcast in each time section of the day?"}, {"role": "assistant", "content": "SELECT count(*) ,  time_of_day FROM broadcast GROUP BY time_of_day"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which allergy is the most common?"}, {"role": "assistant", "content": "SELECT Allergy FROM Has_allergy GROUP BY Allergy ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customers live in Prague city?"}, {"role": "assistant", "content": "SELECT count(*) FROM customers WHERE city = \"Prague\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of employees that have a salary between 100000 and 200000?"}, {"role": "assistant", "content": "SELECT count(*) FROM Employee WHERE salary BETWEEN 100000 AND 200000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all of Alice's friends of friends?"}, {"role": "assistant", "content": "SELECT DISTINCT T4.name FROM PersonFriend AS T1 JOIN Person AS T2 ON T1.name  =  T2.name JOIN PersonFriend AS T3 ON T1.friend  =  T3.name JOIN PersonFriend AS T4 ON T3.friend  =  T4.name WHERE T2.name  =  'Alice' AND T4.name != 'Alice'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first name and age of every student who lives in a dorm with a TV Lounge?"}, {"role": "assistant", "content": "SELECT T1.fname ,  T1.age FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid WHERE T2.dormid NOT IN (SELECT T3.dormid FROM has_amenity AS T3 JOIN dorm_amenity AS T4 ON T3.amenid  =  T4.amenid WHERE T4.amenity_name  =  'TV Lounge')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the student IDs for everybody who worked for more than 10 hours per week on all sports?"}, {"role": "assistant", "content": "SELECT StuID FROM Sportsinfo GROUP BY StuID HAVING sum(hoursperweek)  >  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which student are enrolled in at least two courses? Give me the student ID and personal name."}, {"role": "assistant", "content": "SELECT T1.student_id ,  T2.personal_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the songs produced by artists with first name \"Marianne\"."}, {"role": "assistant", "content": "SELECT T3.Title FROM Performance AS T1 JOIN Band AS T2 ON T1.bandmate  =  T2.id JOIN Songs AS T3 ON T3.SongId  =  T1.SongId WHERE T2.firstname  =  \"Marianne\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many tracks do we have?"}, {"role": "assistant", "content": "SELECT count(*) FROM track"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are all the policy types of the customer that has the most policies listed?"}, {"role": "assistant", "content": "SELECT DISTINCT t3.policy_type_code FROM customers AS t1 JOIN customers_policies AS t2 ON t1.customer_id  =  t2.customer_id JOIN available_policies AS t3 ON t2.policy_id  =  t3.policy_id WHERE t1.customer_name  =  (SELECT t1.customer_name FROM customers AS t1 JOIN customers_policies AS t2 ON t1.customer_id  =  t2.customer_id GROUP BY t1.customer_name ORDER BY count(*) DESC LIMIT 1)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many instrument does the musician with last name \"Heilo\" use?"}, {"role": "assistant", "content": "SELECT count(DISTINCT instrument) FROM instruments AS T1 JOIN Band AS T2 ON T1.bandmateid  =  T2.id WHERE T2.lastname  =  \"Heilo\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the number of kids for the room reserved and checked in by DAMIEN TRACHSEL on  Sep 21, 2010."}, {"role": "assistant", "content": "SELECT Kids FROM Reservations WHERE CheckIn  =  \"2010-09-21\" AND FirstName  =  \"DAMIEN\" AND LastName  =  \"TRACHSEL\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the details for all chip models."}, {"role": "assistant", "content": "SELECT * FROM chip_model"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id of the customer who made the most orders."}, {"role": "assistant", "content": "SELECT T1.customer_id FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the department in the Building Mergenthaler?"}, {"role": "assistant", "content": "SELECT DName FROM DEPARTMENT WHERE Building  =  \"Mergenthaler\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which bike traveled the most often in zip code 94002?"}, {"role": "assistant", "content": "SELECT bike_id FROM trip WHERE zip_code  =  94002 GROUP BY bike_id ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of different film ratings."}, {"role": "assistant", "content": "SELECT count(DISTINCT rating) FROM film"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customers are there of each gender?"}, {"role": "assistant", "content": "SELECT gender ,  count(*) FROM Customers GROUP BY gender"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the description and credit for the course QM-261?"}, {"role": "assistant", "content": "SELECT crs_credit ,  crs_description FROM course WHERE crs_code  =  'QM-261'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the five oldest people?"}, {"role": "assistant", "content": "SELECT Name FROM People ORDER BY Age DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different allergy types exist?"}, {"role": "assistant", "content": "SELECT count(DISTINCT allergytype) FROM Allergy_type"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the headquarters shared by more than two companies."}, {"role": "assistant", "content": "SELECT Headquarters FROM Companies GROUP BY Headquarters HAVING COUNT(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of customers who have once canceled the purchase of the product \"food\" (the item status is \"Cancel\")."}, {"role": "assistant", "content": "SELECT T1.customer_name FROM customers AS T1 JOIN orders AS T2 JOIN order_items AS T3 JOIN products AS T4 ON T1.customer_id = T2.customer_id AND T2.order_id = T3.order_id AND T3.product_id = T4.product_id WHERE T3.order_item_status = \"Cancel\" AND T4.product_name = \"food\" GROUP BY T1.customer_id HAVING count(*)  >=  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which buildings have apartments that have more than two bathrooms? Give me the addresses of the buildings."}, {"role": "assistant", "content": "SELECT T1.building_address FROM Apartment_Buildings AS T1 JOIN Apartments AS T2 ON T1.building_id  =  T2.building_id WHERE T2.bathroom_count  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the details and star ratings of the 3 least expensive hotels."}, {"role": "assistant", "content": "SELECT other_hotel_details ,  star_rating_code FROM HOTELS ORDER BY price_range ASC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the location of the party with the most hosts?"}, {"role": "assistant", "content": "SELECT LOCATION FROM party ORDER BY Number_of_hosts DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the customer information in state NY."}, {"role": "assistant", "content": "SELECT * FROM CUSTOMER WHERE State  =  \"NY\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of journalists from \"England\" or \"Wales\"."}, {"role": "assistant", "content": "SELECT Name FROM journalist WHERE Nationality  =  \"England\" OR Nationality  =  \"Wales\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the youngest editor?"}, {"role": "assistant", "content": "SELECT Name FROM editor ORDER BY Age ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which faculty do not participate in any activity? Find their faculty ids."}, {"role": "assistant", "content": "SELECT FacID FROM Faculty EXCEPT SELECT FacID FROM Faculty_participates_in"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the decor of room Recluse and defiance?"}, {"role": "assistant", "content": "SELECT decor FROM Rooms WHERE roomName  =  \"Recluse and defiance\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the opening years in which at least two shops opened?"}, {"role": "assistant", "content": "SELECT open_year FROM branch GROUP BY open_year HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which address do not have any member with the black membership card?"}, {"role": "assistant", "content": "SELECT address FROM member EXCEPT SELECT address FROM member WHERE Membership_card  =  'Black'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the complete description of the researcher role."}, {"role": "assistant", "content": "SELECT role_description FROM Staff_Roles WHERE role_code  =  'researcher'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What distinct accelerator names are compatible with the browswers that have market share higher than 15?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.name FROM web_client_accelerator AS T1 JOIN accelerator_compatible_browser AS T2 ON T2.accelerator_id  =  T1.id JOIN browser AS T3 ON T2.browser_id  =  T3.id WHERE T3.market_share  >  15;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the artist who produced the shortest song?"}, {"role": "assistant", "content": "SELECT T1.artist_name FROM song AS T1 JOIN files AS T2 ON T1.f_id  =  T2.f_id ORDER BY T2.duration LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of products that are not in any event."}, {"role": "assistant", "content": "SELECT Product_Name FROM Products WHERE Product_ID NOT IN (SELECT Product_ID FROM Products_in_Events)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of accounts whose checking balance is above the average checking balance, but savings balance is below the average savings balance."}, {"role": "assistant", "content": "SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  >  (SELECT avg(balance) FROM checking) INTERSECT SELECT T1.name FROM accounts AS T1 JOIN savings AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT avg(balance) FROM savings)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which customers have orders with status \"Packing\"? Give me the customer names."}, {"role": "assistant", "content": "SELECT DISTINCT T1.customer_name FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id = T2.customer_id WHERE T2.order_status = \"Packing\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many distinct incident type codes are there?"}, {"role": "assistant", "content": "SELECT count(DISTINCT incident_type_code) FROM Behavior_Incident"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many routes does American Airlines operate?"}, {"role": "assistant", "content": "SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the order ids and the number of items in each order."}, {"role": "assistant", "content": "SELECT order_id ,  count(*) FROM Order_items GROUP BY order_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the the full names and ids for all customers, and how many accounts does each have?"}, {"role": "assistant", "content": "SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name ,  count(*) FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the companies and investors that correspond to each entrepreneur?"}, {"role": "assistant", "content": "SELECT Company ,  Investor FROM entrepreneur"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the type of allergy Cat?"}, {"role": "assistant", "content": "SELECT allergytype FROM Allergy_type WHERE allergy  =  \"Cat\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of employees?"}, {"role": "assistant", "content": "SELECT count(*) FROM Employee"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find names of the document without any images."}, {"role": "assistant", "content": "SELECT document_name FROM documents EXCEPT SELECT t1.document_name FROM documents AS t1 JOIN document_sections AS t2 ON t1.document_code  =  t2.document_code JOIN document_sections_images AS t3 ON t2.section_id  =  t3.section_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me ids for all the trip that took place in a zip code area with average mean temperature above 60."}, {"role": "assistant", "content": "SELECT T1.id FROM trip AS T1 JOIN weather AS T2 ON T1.zip_code  =  T2.zip_code GROUP BY T2.zip_code HAVING avg(T2.mean_temperature_f)  >  60"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many debit cards do we have?"}, {"role": "assistant", "content": "SELECT count(*) FROM Customers_cards WHERE card_type_code  =  \"Debit\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different region names, ordered by labels?"}, {"role": "assistant", "content": "SELECT DISTINCT region_name FROM region ORDER BY Label"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the physician who prescribed the highest dose?"}, {"role": "assistant", "content": "SELECT T1.name FROM physician AS T1 JOIN prescribes AS T2 ON T1.employeeid = T2.physician ORDER BY T2.dose DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of captains that have either the rank Midshipman or Lieutenant?"}, {"role": "assistant", "content": "SELECT name FROM captain WHERE rank  =  'Midshipman' OR rank  =  'Lieutenant'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many drivers are from Hartford city or younger than 40?"}, {"role": "assistant", "content": "SELECT count(*) FROM driver WHERE home_city  =  'Hartford' OR age  <  40"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Report the name of all campuses in Los Angeles county."}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE county  =  \"Los Angeles\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all allergies and their types."}, {"role": "assistant", "content": "SELECT allergy ,  allergytype FROM Allergy_type"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many tasks are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM Tasks"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show ids for the faculty members who don't advise any student."}, {"role": "assistant", "content": "SELECT FacID FROM Faculty EXCEPT SELECT advisor FROM Student"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of the artists who are from UK and have produced English songs."}, {"role": "assistant", "content": "SELECT artist_name FROM artist WHERE country  =  \"UK\" INTERSECT SELECT artist_name FROM song WHERE languages  =  \"english\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of different music genres?"}, {"role": "assistant", "content": "SELECT Name FROM GENRE"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many rooms whose capacity is less than 50 does the Lamberton building have?"}, {"role": "assistant", "content": "SELECT count(*) FROM classroom WHERE building  =  'Lamberton' AND capacity  <  50"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the full names and hire dates for employees in the same department as someone with the first name Clara?"}, {"role": "assistant", "content": "SELECT first_name ,  last_name ,  hire_date FROM employees WHERE department_id  =  (SELECT department_id FROM employees WHERE first_name  =  \"Clara\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the opening year in whcih at least two churches opened."}, {"role": "assistant", "content": "SELECT open_date FROM church GROUP BY open_date HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different names of all reviewers whose ratings do not have a date field?"}, {"role": "assistant", "content": "SELECT DISTINCT name FROM Reviewer AS T1 JOIN Rating AS T2 ON T1.rID  =  T2.rID WHERE ratingDate  =  \"null\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first names of all students that are not enrolled in courses?"}, {"role": "assistant", "content": "SELECT Fname FROM STUDENT WHERE StuID NOT IN (SELECT StuID FROM ENROLLED_IN)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the different locations of tracks."}, {"role": "assistant", "content": "SELECT DISTINCT LOCATION FROM track"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the titles of films that include 'Deleted Scenes' in their special feature section."}, {"role": "assistant", "content": "SELECT title FROM film WHERE special_features LIKE '%Deleted Scenes%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and revenue of the company that earns the highest revenue in each city."}, {"role": "assistant", "content": "SELECT name ,  max(revenue) ,  Headquarter FROM manufacturers GROUP BY Headquarter"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the last name and office of all history professors?"}, {"role": "assistant", "content": "SELECT T1.emp_lname ,  T2.prof_office FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T2.dept_code  =  T3.dept_code WHERE T3.dept_name  =  'History'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all instructors with names that include \"dar\"?"}, {"role": "assistant", "content": "SELECT name FROM instructor WHERE name LIKE '%dar%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the type and id of the organization that has the most research staff?"}, {"role": "assistant", "content": "SELECT T1.organisation_type ,  T1.organisation_id FROM Organisations AS T1 JOIN Research_Staff AS T2 ON T1.organisation_id  =  T2.employer_organisation_id GROUP BY T1.organisation_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the headquarters that have at least two companies."}, {"role": "assistant", "content": "SELECT Headquarters FROM company GROUP BY Headquarters HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which language does the film AIRPORT POLLOCK use? List the language name."}, {"role": "assistant", "content": "SELECT T2.name FROM film AS T1 JOIN LANGUAGE AS T2 ON T1.language_id  =  T2.language_id WHERE T1.title  =  'AIRPORT POLLOCK'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id and name of the browser that is compatible with the most web accelerators?"}, {"role": "assistant", "content": "SELECT T1.id ,  T1.name FROM browser AS T1 JOIN accelerator_compatible_browser AS T2 ON T1.id  =  T2.browser_id GROUP BY T1.id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all songs that are ordered by their resolution numbers?"}, {"role": "assistant", "content": "SELECT song_name FROM song ORDER BY resolution"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the total order quantities of photo products?"}, {"role": "assistant", "content": "SELECT sum(T1.Order_Quantity) FROM ORDER_ITEMS AS T1 JOIN Products AS T2 ON T1.Product_ID  =  T2.Product_ID WHERE T2.Product_Name  =  \"photo\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the start dates and end dates of all the apartment bookings made by guests with gender code \"Female\"."}, {"role": "assistant", "content": "SELECT T1.booking_start_date ,  T1.booking_start_date FROM Apartment_Bookings AS T1 JOIN Guests AS T2 ON T1.guest_id  =  T2.guest_id WHERE T2.gender_code  =  \"Female\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me the first name and last name for all the female members of the club \"Bootup Baltimore\"."}, {"role": "assistant", "content": "SELECT t3.fname ,  t3.lname FROM club AS t1 JOIN member_of_club AS t2 ON t1.clubid  =  t2.clubid JOIN student AS t3 ON t2.stuid  =  t3.stuid WHERE t1.clubname  =  \"Bootup Baltimore\" AND t3.sex  =  \"F\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first name and last name of the student who have most number of sports?"}, {"role": "assistant", "content": "SELECT T2.Fname ,  T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Please show the team that has the most number of technicians."}, {"role": "assistant", "content": "SELECT Team FROM technician GROUP BY Team ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the phone numbers and email addresses of all customers who have an outstanding balance of more than 2000?"}, {"role": "assistant", "content": "SELECT phone_number ,  email_address FROM Customers WHERE amount_outstanding  >  2000;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which film actors (actresses) played a role in more than 30 films? List his or her first name and last name."}, {"role": "assistant", "content": "SELECT T2.first_name ,  T2.last_name FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id HAVING count(*)  >  30"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the title and director for all films."}, {"role": "assistant", "content": "SELECT title ,  directed_by FROM film"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the title and director of the films without any schedule?"}, {"role": "assistant", "content": "SELECT title ,  directed_by FROM film WHERE film_id NOT IN (SELECT film_id FROM schedule)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the type codes of the policies used by the customer \"Dayana Robel\"?"}, {"role": "assistant", "content": "SELECT policy_type_code FROM policies AS t1 JOIN customers AS t2 ON t1.customer_id  =  t2.customer_id WHERE t2.customer_details  =  \"Dayana Robel\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the full names of customers with the account name 900?"}, {"role": "assistant", "content": "SELECT T2.customer_first_name ,  T2.customer_last_name FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T1.account_name  =  \"900\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of medications prescribed for each brand."}, {"role": "assistant", "content": "SELECT count(*) ,  T1.name FROM medication AS T1 JOIN prescribes AS T2 ON T1.code = T2.medication GROUP BY T1.brand"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the shipping agent names?"}, {"role": "assistant", "content": "SELECT shipping_agent_name FROM Ref_Shipping_Agents;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Compute the average profits companies make."}, {"role": "assistant", "content": "SELECT avg(Profits_billion) FROM Companies"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the hardware product with the greatest price?"}, {"role": "assistant", "content": "SELECT product_name FROM products WHERE product_type_code  =  'Hardware' ORDER BY product_price DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the bed type and name of all the rooms with traditional decor?"}, {"role": "assistant", "content": "SELECT roomName ,  bedType FROM Rooms WHERE decor = \"traditional\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and ids of customers whose address contains TN?"}, {"role": "assistant", "content": "SELECT customer_name ,  customer_id FROM customers WHERE customer_address LIKE \"%TN%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are all the album titles, in alphabetical order?"}, {"role": "assistant", "content": "SELECT Title FROM ALBUM ORDER BY Title"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "what are the details of the cmi masters that have the cross reference code 'Tax'?"}, {"role": "assistant", "content": "SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T2.source_system_code  =  'Tax'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all male British artists?"}, {"role": "assistant", "content": "SELECT artist_name FROM artist WHERE country  =  \"UK\" AND gender  =  \"Male\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of stadiums that some Australian swimmers have been to."}, {"role": "assistant", "content": "SELECT t4.name FROM swimmer AS t1 JOIN record AS t2 ON t1.id  =  t2.swimmer_id JOIN event AS t3 ON t2.event_id  =  t3.id JOIN stadium AS t4 ON t4.id  =  t3.stadium_id WHERE t1.nationality  =  'Australia'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different courses offered by Physics department?"}, {"role": "assistant", "content": "SELECT count(DISTINCT course_id) FROM course WHERE dept_name  =  'Physics'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the most recent movie?"}, {"role": "assistant", "content": "SELECT title FROM Movie WHERE YEAR  =  (SELECT max(YEAR) FROM Movie)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id and last name of the student that has the most behavior incidents?"}, {"role": "assistant", "content": "SELECT T1.student_id ,  T2.last_name FROM Behavior_Incident AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the types of schools that have two schools."}, {"role": "assistant", "content": "SELECT TYPE FROM school GROUP BY TYPE HAVING count(*)  =  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the dates of birth of entrepreneurs with investor \"Simon Woodroffe\" or \"Peter Jones\"?"}, {"role": "assistant", "content": "SELECT T2.Date_of_Birth FROM entrepreneur AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID WHERE T1.Investor  =  \"Simon Woodroffe\" OR T1.Investor  =  \"Peter Jones\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the institution type with an institution founded after 1990 and an institution with at least 1000 enrollment."}, {"role": "assistant", "content": "SELECT TYPE FROM institution WHERE founded  >  1990 AND enrollment  >=  1000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which authors have last name \"Ueno\"? List their first names."}, {"role": "assistant", "content": "SELECT fname FROM authors WHERE lname  =  \"Ueno\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the document type description for document type named Film?"}, {"role": "assistant", "content": "SELECT document_type_description FROM Ref_document_types WHERE document_type_name  =  \"Film\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many medications are prescribed for each brand?"}, {"role": "assistant", "content": "SELECT count(*) ,  T1.name FROM medication AS T1 JOIN prescribes AS T2 ON T1.code = T2.medication GROUP BY T1.brand"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of devices."}, {"role": "assistant", "content": "SELECT count(*) FROM device"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "find the number of medicines offered by each trade."}, {"role": "assistant", "content": "SELECT trade_name ,  count(*) FROM medicine GROUP BY trade_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the case burdens of counties, ordered descending by population?"}, {"role": "assistant", "content": "SELECT Case_burden FROM county_public_safety ORDER BY Population DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of products with the 'hot' charactersitic."}, {"role": "assistant", "content": "SELECT count(*) FROM products AS t1 JOIN product_characteristics AS t2 ON t1.product_id  =  t2.product_id JOIN CHARACTERISTICS AS t3 ON t2.characteristic_id  =  t3.characteristic_id WHERE t3.characteristic_name  =  \"hot\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the all the assets make, model, details by the disposed date ascendingly."}, {"role": "assistant", "content": "SELECT asset_make ,  asset_model ,  asset_details FROM Assets ORDER BY asset_disposed_date ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and countries of origin for the artists who produced the top three highly rated songs."}, {"role": "assistant", "content": "SELECT T1.artist_name ,  T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name ORDER BY T2.rating DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which service id and type has the least number of participants?"}, {"role": "assistant", "content": "SELECT T3.service_id ,  T4.Service_Type_Code FROM participants AS T1 JOIN Participants_in_Events AS T2 ON T1.Participant_ID  =  T2.Participant_ID JOIN EVENTS AS T3 ON T2.Event_ID   =  T3.Event_ID JOIN services AS T4 ON T3.service_id  =  T4.service_id GROUP BY T3.service_id ORDER BY count(*) ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the ids of the investors who have at least two transactions."}, {"role": "assistant", "content": "SELECT T2.investor_id FROM INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id GROUP BY T2.investor_id HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many home games did the team Boston Red Stockings play from 1990 to 2000 in total?"}, {"role": "assistant", "content": "SELECT sum(T1.games) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T2.name = 'Boston Red Stockings' AND T1.year BETWEEN 1990 AND 2000;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many employees have certificate."}, {"role": "assistant", "content": "SELECT count(DISTINCT eid) FROM Certificate"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the average number of followers for the users who do not have any tweet."}, {"role": "assistant", "content": "SELECT avg(followers) FROM user_profiles WHERE UID NOT IN (SELECT UID FROM tweets)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different names of the genres?"}, {"role": "assistant", "content": "SELECT DISTINCT name FROM genres;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of cities that are in counties that have a crime rate below 100?"}, {"role": "assistant", "content": "SELECT name FROM city WHERE county_id IN (SELECT county_id FROM county_public_safety WHERE Crime_rate  <  100)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and buildings of the deparments, sorted by budget descending?"}, {"role": "assistant", "content": "SELECT dept_name ,  building FROM department ORDER BY budget DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the products that have the color description \"white\" or have the characteristic name \"hot\"."}, {"role": "assistant", "content": "SELECT count(*) FROM products AS t1 JOIN product_characteristics AS t2 ON t1.product_id  =  t2.product_id JOIN CHARACTERISTICS AS t3 ON t2.characteristic_id  =  t3.characteristic_id JOIN ref_colors AS t4 ON t1.color_code  =  t4.color_code WHERE t4.color_description  =  \"white\" OR t3.characteristic_name  =  \"hot\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of colleges with a student population greater than 15000?"}, {"role": "assistant", "content": "SELECT count(*) FROM College WHERE enr  >  15000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names, locations, and years of opening for tracks with seating higher than average?"}, {"role": "assistant", "content": "SELECT name ,  LOCATION ,  year_opened FROM track WHERE seating  >  (SELECT avg(seating) FROM track)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the number of international and domestic passengers of the airport named London \"Heathrow\"?"}, {"role": "assistant", "content": "SELECT International_Passengers ,  Domestic_Passengers FROM airport WHERE Airport_Name  =  \"London Heathrow\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many lessons taken by customer with first name as Rylan and last name as Goodwin were completed?"}, {"role": "assistant", "content": "SELECT count(*) FROM Lessons AS T1 JOIN Customers AS T2 ON T1.customer_id  = T2.customer_id WHERE T2.first_name = \"Rylan\" AND T2.last_name = \"Goodwin\" AND T1.lesson_status_code = \"Completed\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the hometowns shared by people older than 23 and younger than 20."}, {"role": "assistant", "content": "SELECT Hometown FROM people WHERE Age  >  23 INTERSECT SELECT Hometown FROM people WHERE Age  <  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each grade, report the grade, the number of classrooms in which it is taught and the total number of students in the grade."}, {"role": "assistant", "content": "SELECT grade ,  count(DISTINCT classroom) ,  count(*) FROM list GROUP BY grade"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of artworks in ascending order of the year they are nominated in."}, {"role": "assistant", "content": "SELECT T2.Name FROM nomination AS T1 JOIN artwork AS T2 ON T1.Artwork_ID  =  T2.Artwork_ID JOIN festival_detail AS T3 ON T1.Festival_ID  =  T3.Festival_ID ORDER BY T3.Year"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For the problem with id 10, return the ids and dates of its problem logs."}, {"role": "assistant", "content": "SELECT problem_log_id ,  log_entry_date FROM problem_log WHERE problem_id = 10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and building of the department with the highest budget."}, {"role": "assistant", "content": "SELECT dept_name ,  building FROM department ORDER BY budget DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of wrestlers in descending order of days held."}, {"role": "assistant", "content": "SELECT Name FROM wrestler ORDER BY Days_held DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct buildings with capacities of greater than 50?"}, {"role": "assistant", "content": "SELECT DISTINCT building FROM classroom WHERE capacity  >  50"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all region code and region name sorted by the codes."}, {"role": "assistant", "content": "SELECT region_code ,  region_name FROM region ORDER BY region_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the team that have at least two technicians."}, {"role": "assistant", "content": "SELECT Team FROM technician GROUP BY Team HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many artworks are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM artwork"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids and names of the medicine that can interact with two or more enzymes?"}, {"role": "assistant", "content": "SELECT T1.id ,  T1.Name FROM medicine AS T1 JOIN medicine_enzyme_interaction AS T2 ON T2.medicine_id  =  T1.id GROUP BY T1.id HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the zip code the county named \"Howard\" is located in?"}, {"role": "assistant", "content": "SELECT Zip_code FROM county WHERE County_name  =  \"Howard\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of courses with more than 2 credits."}, {"role": "assistant", "content": "SELECT count(*) FROM COURSE WHERE Credits  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the order dates of the orders with price above 1000."}, {"role": "assistant", "content": "SELECT T1.Order_Date FROM Customer_Orders AS T1 JOIN ORDER_ITEMS AS T2 ON T1.Order_ID  =  T2.Order_ID JOIN Products AS T3 ON T2.Product_ID  =  T3.Product_ID WHERE T3.Product_price  >  1000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of students who took a course in the Fall of 2003?"}, {"role": "assistant", "content": "SELECT name FROM student WHERE id IN (SELECT id FROM takes WHERE semester  =  'Fall' AND YEAR  =  2003)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id of the item whose title is \"orange\"."}, {"role": "assistant", "content": "SELECT i_id FROM item WHERE title  =  \"orange\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all transaction ids with transaction code 'PUR'."}, {"role": "assistant", "content": "SELECT transaction_id FROM TRANSACTIONS WHERE transaction_type_code  =  'PUR'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of customers who are living in Colorado?"}, {"role": "assistant", "content": "SELECT t1.customer_name FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.state_province_county  =  \"Colorado\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of candidates who have a lower support rate than oppose rate?"}, {"role": "assistant", "content": "SELECT t1.name FROM people AS t1 JOIN candidate AS t2 ON t1.people_id  =  t2.people_id WHERE t2.support_rate  <  t2.oppose_rate"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the details of the project that is producing both patents and papers as outcomes?"}, {"role": "assistant", "content": "SELECT T1.project_details FROM Projects AS T1 JOIN Project_outcomes AS T2 ON T1.project_id  =  T2.project_id WHERE T2.outcome_code  =  'Paper' INTERSECT SELECT T1.project_details FROM Projects AS T1 JOIN Project_outcomes AS T2 ON T1.project_id  =  T2.project_id WHERE T2.outcome_code  =  'Patent'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the names of movies whose created year is after all movies directed by Steven Spielberg?"}, {"role": "assistant", "content": "SELECT title FROM Movie WHERE YEAR  >  (SELECT max(YEAR) FROM Movie WHERE director  =  \"Steven Spielberg\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the apartment type code that has the largest number of total rooms, together with the number of bathrooms and number of bedrooms."}, {"role": "assistant", "content": "SELECT apt_type_code ,  bathroom_count ,  bedroom_count FROM Apartments GROUP BY apt_type_code ORDER BY sum(room_count) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the area for the appelation which produced the most wines prior to 2010?"}, {"role": "assistant", "content": "SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the players from college UCLA."}, {"role": "assistant", "content": "SELECT Player FROM match_season WHERE College  =  \"UCLA\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and category of the most expensive product."}, {"role": "assistant", "content": "SELECT product_name ,  product_category_code FROM products ORDER BY product_price DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all the distinct districts for elections."}, {"role": "assistant", "content": "SELECT DISTINCT District FROM election"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of any scientists who worked on projects named 'Matter of Time' and 'A Puzzling Pattern'?"}, {"role": "assistant", "content": "SELECT T3.name FROM assignedto AS T1 JOIN projects AS T2 ON T1.project  =  T2.code JOIN scientists AS T3 ON T1.scientist  =  T3.SSN WHERE T2.name  =  'Matter of Time' INTERSECT SELECT T3.name FROM assignedto AS T1 JOIN projects AS T2 ON T1.project  =  T2.code JOIN scientists AS T3 ON T1.scientist  =  T3.SSN WHERE T2.name  =  'A Puzzling Parallax'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "what are the names of people who did not participate in the candidate election."}, {"role": "assistant", "content": "SELECT name FROM people WHERE people_id NOT IN (SELECT people_id FROM candidate)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the crime rates of counties in ascending order of number of police officers."}, {"role": "assistant", "content": "SELECT Crime_rate FROM county_public_safety ORDER BY Police_officers ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each director, what is the title and score of their most poorly rated movie?"}, {"role": "assistant", "content": "SELECT T2.title ,  T1.stars ,  T2.director ,  min(T1.stars) FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID GROUP BY T2.director"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which program is broadcast most frequently? Give me the program name."}, {"role": "assistant", "content": "SELECT t1.name FROM program AS t1 JOIN broadcast AS t2 ON t1.program_id  =  t2.program_id GROUP BY t2.program_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which submission received the highest score in acceptance result. Show me the result."}, {"role": "assistant", "content": "SELECT T1.Result FROM acceptance AS T1 JOIN submission AS T2 ON T1.Submission_ID  =  T2.Submission_ID ORDER BY T2.Scores DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average number of bedrooms of all apartments?"}, {"role": "assistant", "content": "SELECT avg(bedroom_count) FROM Apartments"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the phone numbers of employees with salaries between 8000 and 12000."}, {"role": "assistant", "content": "SELECT phone_number FROM employees WHERE salary BETWEEN 8000 AND 12000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the match ids of the cities that hosted competition \"1994 FIFA World Cup qualification\"?"}, {"role": "assistant", "content": "SELECT match_id FROM MATCH WHERE competition = \"1994 FIFA World Cup qualification\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which order deals with the most items? Return the order id."}, {"role": "assistant", "content": "SELECT T1.order_id FROM orders AS T1 JOIN order_items AS T2 ON T1.order_id = T2.order_id GROUP BY T1.order_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the total number of domestic passengers at all London airports?"}, {"role": "assistant", "content": "SELECT sum(Domestic_Passengers) FROM airport WHERE Airport_Name LIKE \"%London%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the building full names that contain the word \"court\"?"}, {"role": "assistant", "content": "SELECT building_full_name FROM Apartment_Buildings WHERE building_full_name LIKE \"%court%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many products are not made by Sony?"}, {"role": "assistant", "content": "SELECT count(DISTINCT name) FROM products WHERE name NOT IN (SELECT T1.name FROM products AS T1 JOIN manufacturers AS T2 ON T1.Manufacturer  =  T2.code WHERE T2.name  =  'Sony')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many gas station are opened between 2000 and 2005?"}, {"role": "assistant", "content": "SELECT count(*) FROM gas_station WHERE open_year BETWEEN 2000 AND 2005"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the company that produces both furnitures with less than 6 components and furnitures with more than 10 components."}, {"role": "assistant", "content": "SELECT t3.name FROM furniture AS t1 JOIN furniture_manufacte AS t2 ON t1.Furniture_ID  =  t2.Furniture_ID JOIN manufacturer AS t3 ON t2.manufacturer_id  =  t3.manufacturer_id WHERE t1.num_of_component  <  6 INTERSECT SELECT t3.name FROM furniture AS t1 JOIN furniture_manufacte AS t2 ON t1.Furniture_ID  =  t2.Furniture_ID JOIN manufacturer AS t3 ON t2.manufacturer_id  =  t3.manufacturer_id WHERE t1.num_of_component  >  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of markets that have a number of cities lower than 300."}, {"role": "assistant", "content": "SELECT count(*) FROM market WHERE Number_cities  <  300"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the average age of all students living in the each city."}, {"role": "assistant", "content": "SELECT avg(age) ,  city_code FROM student GROUP BY city_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the distinct names of all wines that have prices higher than some wines from John Anthony winery."}, {"role": "assistant", "content": "SELECT DISTINCT Name FROM WINE WHERE Price  >  (SELECT min(Price) FROM wine WHERE Winery  =  \"John Anthony\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the product name and total order quantity for each product."}, {"role": "assistant", "content": "SELECT T1.product_name ,  sum(T2.order_quantity) FROM products AS T1 JOIN order_items AS T2 ON T1.product_id  =  T2.product_id GROUP BY T1.product_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the total claimed amount of all the claims."}, {"role": "assistant", "content": "SELECT sum(Amount_Claimed) FROM Claims"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the customer id with most number of cards, and how many does he have?"}, {"role": "assistant", "content": "SELECT customer_id ,  count(*) FROM Customers_cards GROUP BY customer_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total kills of the perpetrators with height more than 1.84."}, {"role": "assistant", "content": "SELECT sum(T2.Killed) FROM people AS T1 JOIN perpetrator AS T2 ON T1.People_ID  =  T2.People_ID WHERE T1.Height  >  1.84"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the player name, number of matches, and information source for players who do not suffer from injury of 'Knee problem'?"}, {"role": "assistant", "content": "SELECT player ,  number_of_matches ,  SOURCE FROM injury_accident WHERE injury != 'Knee problem'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many courses does the student with id 171 actually attend?"}, {"role": "assistant", "content": "SELECT count(*) FROM courses AS T1 JOIN student_course_attendance AS T2 ON T1.course_id = T2.course_id WHERE T2.student_id = 171"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first and last name of all the German drivers?"}, {"role": "assistant", "content": "SELECT forename ,  surname FROM drivers WHERE nationality = \"German\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and checking balance of the account which has the lowest savings balance?"}, {"role": "assistant", "content": "SELECT T2.balance ,  T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid ORDER BY T3.balance LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For how many clubs is \"Tracy Kim\" a member?"}, {"role": "assistant", "content": "SELECT count(*) FROM club AS t1 JOIN member_of_club AS t2 ON t1.clubid  =  t2.clubid JOIN student AS t3 ON t2.stuid  =  t3.stuid WHERE t3.fname  =  \"Tracy\" AND t3.lname  =  \"Kim\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who are the nominees who were nominated for either of the Bob Fosse or Cleavant Derricks awards?"}, {"role": "assistant", "content": "SELECT Nominee FROM musical WHERE Award  =  \"Tony Award\" OR Award  =  \"Cleavant Derricks\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the titles of all items in alphabetic order ."}, {"role": "assistant", "content": "SELECT title FROM item ORDER BY title"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the minimum, mean, and maximum age across all students?"}, {"role": "assistant", "content": "SELECT min(age) ,  avg(age) ,  max(age) FROM Student"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all directors whose movies are rated by Sarah Martinez."}, {"role": "assistant", "content": "SELECT DISTINCT T2.director FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID JOIN Reviewer AS T3 ON T1.rID  =  T3.rID WHERE T3.name  =  'Sarah Martinez'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the least common faculty rank?"}, {"role": "assistant", "content": "SELECT Rank FROM FACULTY GROUP BY Rank ORDER BY count(*) ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of colors."}, {"role": "assistant", "content": "SELECT count(*) FROM ref_colors"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the most common maximum page size?"}, {"role": "assistant", "content": "SELECT max_page_size FROM product GROUP BY max_page_size ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the cities no customers live in?"}, {"role": "assistant", "content": "SELECT city FROM addresses WHERE city NOT IN ( SELECT DISTINCT t3.city FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Compute the average price of all the products."}, {"role": "assistant", "content": "SELECT avg(price) FROM products"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of students who is older than 20 in each dorm."}, {"role": "assistant", "content": "SELECT count(*) ,  T3.dorm_name FROM student AS T1 JOIN lives_in AS T2 ON T1.stuid  =  T2.stuid JOIN dorm AS T3 ON T3.dormid  =  T2.dormid WHERE T1.age  >  20 GROUP BY T3.dorm_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the maximum duration and resolution of songs grouped and ordered by languages?"}, {"role": "assistant", "content": "SELECT max(T1.duration) ,  max(T2.resolution) ,  T2.languages FROM files AS T1 JOIN song AS T2 ON T1.f_id  =  T2.f_id GROUP BY T2.languages ORDER BY T2.languages"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the department name and room of the course INTRODUCTION TO COMPUTER SCIENCE."}, {"role": "assistant", "content": "SELECT T2.Dname ,  T2.Room FROM COURSE AS T1 JOIN DEPARTMENT AS T2 ON T1.DNO  =  T2.DNO WHERE T1.CName  =  \"INTRODUCTION TO COMPUTER SCIENCE\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of musicals who have at 3 or more actors?"}, {"role": "assistant", "content": "SELECT T2.Name FROM actor AS T1 JOIN musical AS T2 ON T1.Musical_ID  =  T2.Musical_ID GROUP BY T1.Musical_ID HAVING COUNT(*)  >=  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the busiest destination airport that runs most number of routes in China."}, {"role": "assistant", "content": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which physicians are affiliated with either Surgery or Psychiatry department? Give me their names."}, {"role": "assistant", "content": "SELECT T1.name FROM physician AS T1 JOIN affiliated_with AS T2 ON T1.EmployeeID  =  T2.physician JOIN department AS T3 ON T2.department  =  T3.DepartmentID WHERE T3.name  =  'Surgery' OR T3.name  =  'Psychiatry'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each constructor id, how many races are there?"}, {"role": "assistant", "content": "SELECT count(*) ,  constructorid FROM constructorStandings GROUP BY constructorid"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of distinct bed types available in this inn."}, {"role": "assistant", "content": "SELECT count(DISTINCT bedType) FROM Rooms;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the entry name of the most expensive catalog (in USD)?"}, {"role": "assistant", "content": "SELECT catalog_entry_name FROM catalog_contents ORDER BY price_in_dollars DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the product with the color description 'yellow'?"}, {"role": "assistant", "content": "SELECT T1.product_name FROM products AS T1 JOIN ref_colors AS T2 ON T1.color_code  =  T2.color_code WHERE T2.color_description  =  'yellow'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the airports which are not in the country 'Iceland'?"}, {"role": "assistant", "content": "SELECT name FROM airport WHERE country != 'Iceland'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many instructors teach a course in the Spring of 2010?"}, {"role": "assistant", "content": "SELECT COUNT (DISTINCT ID) FROM teaches WHERE semester  =  'Spring' AND YEAR  =  2010"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the busiest source airport that runs most number of routes in China."}, {"role": "assistant", "content": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many devices are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM device"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which publishers did not publish a book in 1989?"}, {"role": "assistant", "content": "SELECT publisher FROM book_club EXCEPT SELECT publisher FROM book_club WHERE YEAR  =  1989"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many games are played for all students?"}, {"role": "assistant", "content": "SELECT sum(gamesplayed) FROM Sportsinfo"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the official names of the cities that have hosted more than one competition."}, {"role": "assistant", "content": "SELECT T1.Official_Name FROM city AS T1 JOIN farm_competition AS T2 ON T1.City_ID  =  T2.Host_city_ID GROUP BY T2.Host_city_ID HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of customers who live in the city called Lake Geovannyton."}, {"role": "assistant", "content": "SELECT count(*) FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.city  =  \"Lake Geovannyton\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct first names for students with a grade point of 3.8 or above in at least one course?"}, {"role": "assistant", "content": "SELECT DISTINCT T3.Fname FROM ENROLLED_IN AS T1 JOIN GRADECONVERSION AS T2 JOIN STUDENT AS T3 ON T1.Grade  =  T2.lettergrade AND T1.StuID  =  T3.StuID WHERE T2.gradepoint  >=  3.8"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the distinct details of invoices which are created before 1989-09-03 or after 2007-12-25."}, {"role": "assistant", "content": "SELECT DISTINCT invoice_details FROM invoices WHERE invoice_date < \"1989-09-03\" OR invoice_date > \"2007-12-25\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different classes of races, and how many races correspond to each?"}, {"role": "assistant", "content": "SELECT CLASS ,  count(*) FROM race GROUP BY CLASS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the maximum and minimum sales of the companies that are not in the \"Banking\" industry."}, {"role": "assistant", "content": "SELECT max(Sales_billion) ,  min(Sales_billion) FROM Companies WHERE Industry != \"Banking\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What country is the artist who made the fewest songs from?"}, {"role": "assistant", "content": "SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name GROUP BY T2.artist_name ORDER BY count(*) LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the chairs of festivals, sorted in ascending order of the year held?"}, {"role": "assistant", "content": "SELECT Chair_Name FROM festival_detail ORDER BY YEAR ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which marketing region has the most drama workshop groups? Give me the region code."}, {"role": "assistant", "content": "SELECT Marketing_Region_Code FROM Drama_Workshop_Groups GROUP BY Marketing_Region_Code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which campus was opened between 1935 and 1939?"}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE YEAR  >=  1935 AND YEAR  <=  1939"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of the students who are under 20 years old and are involved in at least one activity."}, {"role": "assistant", "content": "SELECT StuID FROM Participates_in INTERSECT SELECT StuID FROM Student WHERE age  <  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show each apartment type code, and the maximum and minimum number of rooms for each type."}, {"role": "assistant", "content": "SELECT apt_type_code ,  max(room_count) ,  min(room_count) FROM Apartments GROUP BY apt_type_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first names of the teachers that teach first grade."}, {"role": "assistant", "content": "SELECT DISTINCT T2.firstname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the phone and email of the customer with the first name Aniyah and last name Feest."}, {"role": "assistant", "content": "SELECT customer_phone ,  customer_email FROM Customers WHERE customer_first_name  =  \"Aniyah\" AND customer_last_name  =  \"Feest\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of races held between 2009 and 2011?"}, {"role": "assistant", "content": "SELECT name FROM races WHERE YEAR BETWEEN 2009 AND 2011"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the planned delivery date and actual delivery date for each booking?"}, {"role": "assistant", "content": "SELECT Planned_Delivery_Date ,  Actual_Delivery_Date FROM BOOKINGS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show different locations and the number of performances at each location."}, {"role": "assistant", "content": "SELECT LOCATION ,  COUNT(*) FROM performance GROUP BY LOCATION"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the first names and last names of employees who earn more than 30000 in salary."}, {"role": "assistant", "content": "SELECT fname ,  lname FROM employee WHERE salary  >  30000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all the customers and staff members."}, {"role": "assistant", "content": "SELECT customer_details FROM customers UNION SELECT staff_details FROM staff"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all employees in the circulation history of the document with id 1. List the employee's name."}, {"role": "assistant", "content": "SELECT Employees.employee_name FROM Employees JOIN Circulation_History ON Circulation_History.employee_id = Employees.employee_id WHERE Circulation_History.document_id = 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which parts have more than 2 faults? Show the part name and id."}, {"role": "assistant", "content": "SELECT T1.part_name ,  T1.part_id FROM Parts AS T1 JOIN Part_Faults AS T2 ON T1.part_id  =  T2.part_id GROUP BY T1.part_id HAVING count(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last names of faculties in building Barton in alphabetic order."}, {"role": "assistant", "content": "SELECT Lname FROM FACULTY WHERE Building  =  \"Barton\" ORDER BY Lname"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the emails and phone numbers of custoemrs who have never filed a complaint?"}, {"role": "assistant", "content": "SELECT email_address ,  phone_number FROM customers WHERE customer_id NOT IN (SELECT customer_id FROM complaints)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the songs whose rating is below the rating of all songs in English?"}, {"role": "assistant", "content": "SELECT song_name FROM song WHERE rating  <   (SELECT min(rating) FROM song WHERE languages  =  'english')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of regions that were not affected?"}, {"role": "assistant", "content": "SELECT region_name FROM region WHERE region_id NOT IN (SELECT region_id FROM affected_region)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me the the customer details and id for the customers who had two or more policies but did not file any claims."}, {"role": "assistant", "content": "SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >=  2 EXCEPT SELECT T1.customer_details ,  T1.customer_id FROM Customers AS T1 JOIN Customer_Policies AS T2 ON T1.Customer_id  =  T2.customer_id JOIN Claims AS T3 ON T2.policy_id  =  T3.policy_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id and name of the staff who has been assigned for the shortest period."}, {"role": "assistant", "content": "SELECT T1.staff_id ,  T1.staff_name FROM staff AS T1 JOIN Staff_Department_Assignments AS T2 ON T1.staff_id  =  T2.staff_id ORDER BY date_assigned_to - date_assigned_from LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the top 10 customers' first and last names with the highest gross sales, and also what are the sales?"}, {"role": "assistant", "content": "SELECT T1.first_name ,  T1.last_name ,  SUM(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T2.customer_id  =  T1.id GROUP BY T1.id ORDER BY SUM(T2.total) DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each company, return the company name and the name of the building its office is located in."}, {"role": "assistant", "content": "SELECT T3.name ,  T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many animal type allergies exist?"}, {"role": "assistant", "content": "SELECT count(*) FROM Allergy_type WHERE allergytype  =  \"animal\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the number of transaction types."}, {"role": "assistant", "content": "SELECT count(DISTINCT transaction_type) FROM Financial_Transactions"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all payment methods and number of payments using each payment methods."}, {"role": "assistant", "content": "SELECT payment_method_code ,  count(*) FROM Customer_Payments GROUP BY payment_method_code;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which buildings have more than one company offices? Give me the building names."}, {"role": "assistant", "content": "SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many invoices correspond to each order id?"}, {"role": "assistant", "content": "SELECT order_id ,  count(*) FROM Invoices GROUP BY order_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the staff that is in charge of the attraction named \"US museum\"?"}, {"role": "assistant", "content": "SELECT T1.Name FROM STAFF AS T1 JOIN TOURIST_ATTRACTIONS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID WHERE T2.Name  =  \"US museum\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is average and maximum salary of all employees."}, {"role": "assistant", "content": "SELECT avg(salary) ,  max(salary) FROM Employee"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the payment method and phone of the party with email \"enrico09@example.com\"."}, {"role": "assistant", "content": "SELECT payment_method_code ,  party_phone FROM parties WHERE party_email  =  \"enrico09@example.com\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show names of technicians and series of machines they are assigned to repair."}, {"role": "assistant", "content": "SELECT T3.Name ,  T2.Machine_series FROM repair_assignment AS T1 JOIN machine AS T2 ON T1.machine_id  =  T2.machine_id JOIN technician AS T3 ON T1.technician_ID  =  T3.technician_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of airline which runs the most number of routes."}, {"role": "assistant", "content": "SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many drivers are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM driver"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and price of the cheapest product?"}, {"role": "assistant", "content": "SELECT name ,  price FROM Products ORDER BY price ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the last name of the staff who has handled the first ever complaint?"}, {"role": "assistant", "content": "SELECT t1.last_name FROM staff AS t1 JOIN complaints AS t2 ON t1.staff_id  =  t2.staff_id ORDER BY t2.date_complaint_raised LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the distinct district names ordered by city area in descending."}, {"role": "assistant", "content": "SELECT DISTINCT District_name FROM district ORDER BY city_area DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each team, return the team name, id and the maximum salary among the team."}, {"role": "assistant", "content": "SELECT T1.name ,  T1.team_id ,  max(T2.salary) FROM team AS T1 JOIN salary AS T2 ON T1.team_id  =  T2.team_id GROUP BY T1.team_id;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the invoice numbers which are created before 1989-09-03 or after 2007-12-25."}, {"role": "assistant", "content": "SELECT invoice_number FROM invoices WHERE invoice_date < \"1989-09-03\" OR invoice_date > \"2007-12-25\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the distinct driver id of all drivers that have a longer stop duration than some drivers in the race whose id is 841?"}, {"role": "assistant", "content": "SELECT DISTINCT driverid ,  STOP FROM pitstops WHERE duration  >  (SELECT min(duration) FROM pitstops WHERE raceid  =  841)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return all the distinct payment methods used by customers."}, {"role": "assistant", "content": "SELECT DISTINCT payment_method FROM customers"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the title of the course with Differential Geometry as a prerequisite?"}, {"role": "assistant", "content": "SELECT title FROM course WHERE course_id IN (SELECT T1.course_id FROM prereq AS T1 JOIN course AS T2 ON T1.prereq_id  =  T2.course_id WHERE T2.title  =  'Differential Geometry')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and address of the customers who have both New and Pending orders."}, {"role": "assistant", "content": "SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  \"New\" INTERSECT SELECT T1.customer_name ,  T1.customer_address FROM customers AS T1 JOIN customer_orders AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.order_status_code  =  \"Pending\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the full names and salaries for employees with first names that end with the letter m."}, {"role": "assistant", "content": "SELECT first_name ,  last_name ,  salary FROM employees WHERE first_name LIKE '%m'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the description and credit of the course which the student whose last name is Smithson took?"}, {"role": "assistant", "content": "SELECT T4.crs_description ,  T4.crs_credit FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num JOIN course AS T4 ON T4.crs_code  =  T1.crs_code WHERE T3.stu_lname  =  'Smithson'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the count of aircrafts that have a distance between 1000 and 5000?"}, {"role": "assistant", "content": "SELECT count(*) FROM Aircraft WHERE distance BETWEEN 1000 AND 5000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many stadiums are not in country \"Russia\"?"}, {"role": "assistant", "content": "SELECT count(*) FROM stadium WHERE country != 'Russia'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of perpetrators?"}, {"role": "assistant", "content": "SELECT T1.Name FROM people AS T1 JOIN perpetrator AS T2 ON T1.People_ID  =  T2.People_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all destinations and the number of flights to each destination."}, {"role": "assistant", "content": "SELECT destination ,  count(*) FROM Flight GROUP BY destination"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the claim dates and settlement dates of all the settlements?"}, {"role": "assistant", "content": "SELECT Date_Claim_Made ,  Date_Claim_Settled FROM Settlements"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customer cards are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM Customers_cards"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the codes of document types that have more than 2 corresponding documents."}, {"role": "assistant", "content": "SELECT document_type_code FROM documents GROUP BY document_type_code HAVING count(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many actors have appeared in each musical?"}, {"role": "assistant", "content": "SELECT T2.Name ,  COUNT(*) FROM actor AS T1 JOIN musical AS T2 ON T1.Musical_ID  =  T2.Musical_ID GROUP BY T1.Musical_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of catalog entries with level number 8?"}, {"role": "assistant", "content": "SELECT t1.catalog_entry_name FROM Catalog_Contents AS t1 JOIN Catalog_Contents_Additional_Attributes AS t2 ON t1.catalog_entry_id  =  t2.catalog_entry_id WHERE t2.catalog_level_number  =  \"8\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the three most costly procedures?"}, {"role": "assistant", "content": "SELECT name FROM procedures ORDER BY cost LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are ids of the all distinct orders, sorted by placement date?"}, {"role": "assistant", "content": "SELECT DISTINCT order_id FROM orders ORDER BY date_order_placed"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many games has each stadium held?"}, {"role": "assistant", "content": "SELECT T1.id ,  count(*) FROM stadium AS T1 JOIN game AS T2 ON T1.id  =  T2.stadium_id GROUP BY T1.id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different positions of players are there?"}, {"role": "assistant", "content": "SELECT count(DISTINCT POSITION) FROM player"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which orders are made by the customer named \"Jeramie\"? Give me the order ids and status."}, {"role": "assistant", "content": "SELECT T2.order_id ,  T2.order_status FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_name = \"Jeramie\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name and office of history professor who did not get a Ph.D. degree."}, {"role": "assistant", "content": "SELECT T2.emp_fname ,  T1.prof_office FROM professor AS T1 JOIN employee AS T2 ON T1.emp_num  =  T2.emp_num JOIN department AS T3 ON T1.dept_code  =  T3.dept_code WHERE T3.dept_name  =  'History' AND T1.prof_high_degree != 'Ph.D.'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the payment method code used by the most orders?"}, {"role": "assistant", "content": "SELECT payment_method_code FROM INVOICES GROUP BY payment_method_code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the maximum and total number of followers of all users."}, {"role": "assistant", "content": "SELECT max(followers) ,  sum(followers) FROM user_profiles"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the name and level of catalog structure with level number between 5 and 10"}, {"role": "assistant", "content": "SELECT catalog_level_name ,  catalog_level_number FROM Catalog_Structure WHERE catalog_level_number BETWEEN 5 AND 10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of all students who have advisor number 1121?"}, {"role": "assistant", "content": "SELECT StuID FROM Student WHERE Advisor  =  1121"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many students are enrolled in colleges that have student accepted during tryouts, and in which states are those colleges?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.state ,  T1.enr FROM college AS T1 JOIN tryout AS T2 ON T1.cName  =  T2.cName WHERE T2.decision  =  'yes'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the films longer than 100 minutes, or rated PG, except those who cost more than 200 for replacement. List the titles."}, {"role": "assistant", "content": "SELECT title FROM film WHERE LENGTH  >  100 OR rating  =  'PG' EXCEPT SELECT title FROM film WHERE replacement_cost  >  200"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the job ID for those jobs which average salary is above 8000."}, {"role": "assistant", "content": "SELECT job_id FROM employees GROUP BY job_id HAVING AVG(salary) > 8000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the cameras that have taken picture of the most mountains?"}, {"role": "assistant", "content": "SELECT T2.name FROM photos AS T1 JOIN camera_lens AS T2 ON T1.camera_lens_id  =  T2.id GROUP BY T2.id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all songs that have a lower rating than some song of blues genre?"}, {"role": "assistant", "content": "SELECT song_name FROM song WHERE rating  <  (SELECT max(rating) FROM song WHERE genre_is  =  \"blues\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different names of mountains ascended by climbers from the country of West Germany?"}, {"role": "assistant", "content": "SELECT DISTINCT T2.Name FROM climber AS T1 JOIN mountain AS T2 ON T1.Mountain_ID  =  T2.Mountain_ID WHERE T1.Country  =  \"West Germany\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which parties have delegates in both the \"Appropriations\" committee and the \"Economic Matters\" committee?"}, {"role": "assistant", "content": "SELECT T2.Party FROM election AS T1 JOIN party AS T2 ON T1.Party  =  T2.Party_ID WHERE T1.Committee  =  \"Appropriations\" INTERSECT SELECT T2.Party FROM election AS T1 JOIN party AS T2 ON T1.Party  =  T2.Party_ID WHERE T1.Committee  =  \"Economic Matters\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What details are there on the research staff? List the result in ascending alphabetical order."}, {"role": "assistant", "content": "SELECT staff_details FROM Research_Staff ORDER BY staff_details ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return all information about employees with salaries between 8000 and 12000 for which commission is not null or where their department id is not 40."}, {"role": "assistant", "content": "SELECT * FROM employees WHERE salary BETWEEN 8000 AND 12000 AND commission_pct != \"null\" OR  department_id != 40"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the full name, hire date, salary, and department id for employees without the letter M in their first name?"}, {"role": "assistant", "content": "SELECT first_name ,  last_name ,  hire_date ,  salary ,  department_id FROM employees WHERE first_name NOT LIKE '%M%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the movies with the highest average rating. Return the movie titles and average rating."}, {"role": "assistant", "content": "SELECT T2.title ,  avg(T1.stars) FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID GROUP BY T1.mID ORDER BY avg(T1.stars) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "how many schools exist in total?"}, {"role": "assistant", "content": "SELECT count(DISTINCT school_code) FROM department"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Report the first name and last name of all the students."}, {"role": "assistant", "content": "SELECT DISTINCT firstname ,  lastname FROM list"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me the zip code where the average mean humidity is below 70 and at least 100 trips took place."}, {"role": "assistant", "content": "SELECT zip_code FROM weather GROUP BY zip_code HAVING avg(mean_humidity)  <  70 INTERSECT SELECT zip_code FROM trip GROUP BY zip_code HAVING count(*)  >=  100"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the checking balance of the account whose owner\u2019s name contains the substring \u2018ee\u2019?"}, {"role": "assistant", "content": "SELECT T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T1.name LIKE '%ee%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List first name and last name of customers that have more than 2 payments."}, {"role": "assistant", "content": "SELECT T2.first_name ,  T2.last_name FROM Customer_Payments AS T1 JOIN Customers AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.customer_id HAVING count(*)  >  2;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the companies of entrepreneurs, ordered descending by amount of money requested?"}, {"role": "assistant", "content": "SELECT Company FROM entrepreneur ORDER BY Money_Requested DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last names of students studying in room 111."}, {"role": "assistant", "content": "SELECT lastname FROM list WHERE classroom  =  111"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of financial transactions that the account with the name 337 has."}, {"role": "assistant", "content": "SELECT count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id WHERE T2.account_name  =  \"337\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the list of attribute data types possessed by more than 3 attribute definitions."}, {"role": "assistant", "content": "SELECT attribute_data_type FROM Attribute_Definitions GROUP BY attribute_data_type HAVING count(*)  >  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of artists for each gender?"}, {"role": "assistant", "content": "SELECT count(*) ,  gender FROM artist GROUP BY gender"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all directors who made one movie?"}, {"role": "assistant", "content": "SELECT director FROM Movie GROUP BY director HAVING count(*)  =  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids, names, dates of opening, and other details for accounts corresponding to the customer with the first name \"Meaghan\"?"}, {"role": "assistant", "content": "SELECT T1.account_id ,  T1.date_account_opened ,  T1.account_name ,  T1.other_account_details FROM Accounts AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T2.customer_first_name  =  'Meaghan'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many students are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM student"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the hosts of performances in ascending order of attendance."}, {"role": "assistant", "content": "SELECT HOST FROM performance ORDER BY Attendance ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all the states with college students playing in the mid position but no goalies?"}, {"role": "assistant", "content": "SELECT T1.state FROM college AS T1 JOIN tryout AS T2 ON T1.cName  =  T2.cName WHERE T2.pPos  =  'mid' EXCEPT SELECT T1.state FROM college AS T1 JOIN tryout AS T2 ON T1.cName  =  T2.cName WHERE T2.pPos  =  'goalie'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of instructors who taught in the Fall of 2009 but not in the Spring of 2010?"}, {"role": "assistant", "content": "SELECT id FROM teaches WHERE semester  =  'Fall' AND YEAR  =  2009 EXCEPT SELECT id FROM teaches WHERE semester  =  'Spring' AND YEAR  =  2010"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the code of the city with the most students?"}, {"role": "assistant", "content": "SELECT city_code FROM student GROUP BY city_code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the zip code in which the average mean sea level pressure is the lowest?"}, {"role": "assistant", "content": "SELECT zip_code FROM weather GROUP BY zip_code ORDER BY avg(mean_sea_level_pressure_inches) LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the date and venue of each workshop in ascending alphabetical order of the venue."}, {"role": "assistant", "content": "SELECT Date ,  Venue FROM workshop ORDER BY Venue"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What amenities does Smith Hall have in alphabetical order?"}, {"role": "assistant", "content": "SELECT T3.amenity_name FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid WHERE T1.dorm_name  =  'Smith Hall' ORDER BY T3.amenity_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of regions."}, {"role": "assistant", "content": "SELECT count(*) FROM region"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How much is the track Fast As a Shark?"}, {"role": "assistant", "content": "SELECT unit_price FROM tracks WHERE name = \"Fast As a Shark\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of entrepreneurs and their corresponding investors, ordered descending by the amount of money requested?"}, {"role": "assistant", "content": "SELECT T2.Name ,  T1.Company FROM entrepreneur AS T1 JOIN people AS T2 ON T1.People_ID  =  T2.People_ID ORDER BY T1.Money_Requested"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the card type codes and the number of transactions."}, {"role": "assistant", "content": "SELECT T2.card_type_code ,  count(*) FROM Financial_transactions AS T1 JOIN Customers_cards AS T2 ON T1.card_id  =  T2.card_id GROUP BY T2.card_type_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different industries are the companies in?"}, {"role": "assistant", "content": "SELECT count(DISTINCT Industry) FROM Companies"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of papers published by the institution \"University of Pennsylvania\"."}, {"role": "assistant", "content": "SELECT count(DISTINCT t1.title) FROM papers AS t1 JOIN authorship AS t2 ON t1.paperid  =  t2.paperid JOIN inst AS t3 ON t2.instid  =  t3.instid WHERE t3.name  =  \"University of Pennsylvania\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the location codes and the number of documents in each location."}, {"role": "assistant", "content": "SELECT location_code ,  count(*) FROM Document_locations GROUP BY location_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the id of students who never attends courses?"}, {"role": "assistant", "content": "SELECT student_id FROM students WHERE student_id NOT IN (SELECT student_id FROM student_course_attendance)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are dates of birth of all the guests whose gender is \"Male\"?"}, {"role": "assistant", "content": "SELECT date_of_birth FROM Guests WHERE gender_code  =  \"Male\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first names of the professors who do not teach a class."}, {"role": "assistant", "content": "SELECT emp_fname FROM employee WHERE emp_jobcode  =  'PROF' EXCEPT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the countries for appelations with at most 3 wines?"}, {"role": "assistant", "content": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of documents with expenses."}, {"role": "assistant", "content": "SELECT count(*) FROM Documents_with_expenses"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the most popular full name of the actors?"}, {"role": "assistant", "content": "SELECT first_name ,  last_name FROM actor GROUP BY first_name ,  last_name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the ids of all employees who have destroyed a document."}, {"role": "assistant", "content": "SELECT DISTINCT Destroyed_by_Employee_ID FROM Documents_to_be_destroyed"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different ages of editors? Show each age along with the number of editors of that age."}, {"role": "assistant", "content": "SELECT Age ,  COUNT(*) FROM editor GROUP BY Age"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the employee ids for each employee and final dates of employment at their last job?"}, {"role": "assistant", "content": "SELECT employee_id ,  MAX(end_date) FROM job_history GROUP BY employee_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and sum of checking and savings balances for accounts with savings balances higher than the average savings balance?"}, {"role": "assistant", "content": "SELECT T1.name ,  T2.balance + T3.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T3.balance  >  (SELECT avg(balance) FROM savings)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many drivers were in the Australian Grand Prix held in 2009?"}, {"role": "assistant", "content": "SELECT count(*) FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid WHERE T2.name = \"Australian Grand Prix\" AND YEAR = 2009"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are all the role codes, role names, and role descriptions?"}, {"role": "assistant", "content": "SELECT role_code ,  role_name ,  role_description FROM ROLES"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name, born state and age of the heads of departments ordered by age."}, {"role": "assistant", "content": "SELECT name ,  born_state ,  age FROM head ORDER BY age"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average rating for right-footed players and left-footed players?"}, {"role": "assistant", "content": "SELECT preferred_foot ,  avg(overall_rating) FROM Player_Attributes GROUP BY preferred_foot"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name all districts with city area greater than 10 or population larger than 100000"}, {"role": "assistant", "content": "SELECT district_name FROM district WHERE city_area  >  10 OR City_Population  >  100000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the enrollment and primary_conference of the oldest college."}, {"role": "assistant", "content": "SELECT enrollment ,  primary_conference FROM university ORDER BY founded LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which major has least number of students? List the major and the number of students."}, {"role": "assistant", "content": "SELECT Major ,  count(*) FROM Student GROUP BY Major ORDER BY count(Major) ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the team of each player and sort them in ascending alphabetical order."}, {"role": "assistant", "content": "SELECT Team FROM player ORDER BY Team ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many airlines operate out of each country in descending order?"}, {"role": "assistant", "content": "SELECT country ,  count(*) FROM airlines GROUP BY country ORDER BY count(*) DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the amount and donor name for the largest amount of donation."}, {"role": "assistant", "content": "SELECT amount ,  donator_name FROM endowment ORDER BY amount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct years in which the competitions type is not \"Tournament\"?"}, {"role": "assistant", "content": "SELECT DISTINCT YEAR FROM competition WHERE Competition_type != \"Tournament\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of people who are shorter than average?"}, {"role": "assistant", "content": "SELECT name FROM people WHERE height  <  (SELECT avg(height) FROM people)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all of the player ids with a height of at least 180cm and an overall rating higher than 85."}, {"role": "assistant", "content": "SELECT player_api_id FROM Player WHERE height  >=  180 INTERSECT SELECT player_api_id FROM Player_Attributes WHERE overall_rating  >  85"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the name and payment method of customers who have both mailshots in 'Order' outcome and mailshots in 'No Response' outcome."}, {"role": "assistant", "content": "SELECT T2.customer_name ,  T2.payment_method FROM mailshot_customers AS T1 JOIN customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T1.outcome_code  =  'Order' INTERSECT SELECT T2.customer_name ,  T2.payment_method FROM mailshot_customers AS T1 JOIN customers AS T2 ON T1.customer_id  =  T2.customer_id WHERE T1.outcome_code  =  'No Response'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are department ids for departments with managers managing more than 3 employees?"}, {"role": "assistant", "content": "SELECT DISTINCT department_id FROM employees GROUP BY department_id ,  manager_id HAVING COUNT(employee_id)  >= 4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How long does track Fast As a Shark has?"}, {"role": "assistant", "content": "SELECT milliseconds FROM tracks WHERE name = \"Fast As a Shark\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of cities in Australia."}, {"role": "assistant", "content": "SELECT count(*) FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id WHERE T2.country  =  'Australia'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many dorms are there and what is the total capacity for each gender?"}, {"role": "assistant", "content": "SELECT count(*) ,  sum(student_capacity) ,  gender FROM dorm GROUP BY gender"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the employee ids for those who had two or more jobs."}, {"role": "assistant", "content": "SELECT employee_id FROM job_history GROUP BY employee_id HAVING COUNT(*)  >= 2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of documents that have both one of the three most common types and one of three most common structures?"}, {"role": "assistant", "content": "SELECT document_name FROM documents GROUP BY document_type_code ORDER BY count(*) DESC LIMIT 3 INTERSECT SELECT document_name FROM documents GROUP BY document_structure_code ORDER BY count(*) DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the film title and inventory id of the item in the inventory which was rented most frequently?"}, {"role": "assistant", "content": "SELECT T1.title ,  T2.inventory_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id JOIN rental AS T3 ON T2.inventory_id  =  T3.inventory_id GROUP BY T2.inventory_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the city with the most customers?"}, {"role": "assistant", "content": "SELECT T2.city FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id GROUP BY T2.city ORDER BY count(*) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the distinct famous release dates for all artists."}, {"role": "assistant", "content": "SELECT distinct(Famous_Release_date) FROM artist"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of students in one classroom."}, {"role": "assistant", "content": "SELECT count(*) ,  classroom FROM list GROUP BY classroom"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which tourist attractions can we get to by bus? Tell me the names of the attractions."}, {"role": "assistant", "content": "SELECT Name FROM TOURIST_ATTRACTIONS WHERE How_to_Get_There  =  \"bus\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all card type codes and the number of customers holding cards in each type."}, {"role": "assistant", "content": "SELECT card_type_code ,  count(DISTINCT customer_id) FROM Customers_cards GROUP BY card_type_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the lifespans of representatives in descending order of vote percent?"}, {"role": "assistant", "content": "SELECT T2.Lifespan FROM election AS T1 JOIN representative AS T2 ON T1.Representative_ID  =  T2.Representative_ID ORDER BY Vote_Percent DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the types of vocals that the band member with the first name \"Solveig\" played the most?"}, {"role": "assistant", "content": "SELECT TYPE FROM vocals AS T1 JOIN band AS T2 ON T1.bandmate  =  T2.id WHERE firstname  =  \"Solveig\" GROUP BY TYPE ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the student ID and login name of the student who are enrolled in the most courses?"}, {"role": "assistant", "content": "SELECT T1.student_id ,  T2.login_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of all distinct races in reversed  lexicographic order?"}, {"role": "assistant", "content": "SELECT DISTINCT name FROM races ORDER BY name DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "report the total number of degrees granted between 1998 and 2002."}, {"role": "assistant", "content": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T2.year  >=  1998 AND T2.year  <=  2002 GROUP BY T1.campus"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the apartment number with the largest number of bedrooms."}, {"role": "assistant", "content": "SELECT apt_number FROM Apartments ORDER BY bedroom_count DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of the buildings that have more than one company offices."}, {"role": "assistant", "content": "SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which channels are broadcast in the morning? Give me the channel names."}, {"role": "assistant", "content": "SELECT t1.name FROM channel AS t1 JOIN broadcast AS t2 ON t1.channel_id  =  t2.channel_id WHERE t2.time_of_day  =  'Morning'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the categories of music festivals that have the result \"Awarded\"."}, {"role": "assistant", "content": "SELECT Category FROM music_festival WHERE RESULT  =  \"Awarded\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the technicians  and how many machines are they assigned to repair?"}, {"role": "assistant", "content": "SELECT T2.Name ,  COUNT(*) FROM repair_assignment AS T1 JOIN technician AS T2 ON T1.technician_ID  =  T2.technician_ID GROUP BY T2.Name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many total credits are offered by each department?"}, {"role": "assistant", "content": "SELECT sum(credits) ,  dept_name FROM course GROUP BY dept_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids and names of accounts with 4 or more transactions?"}, {"role": "assistant", "content": "SELECT T1.account_id ,  T2.account_name FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id HAVING count(*)  >=  4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many students attend course English?"}, {"role": "assistant", "content": "SELECT count(*) FROM courses AS T1 JOIN student_course_attendance AS T2 ON T1.course_id = T2.course_id WHERE T1.course_name = \"English\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the velocity of the pilot named 'Thompson'?"}, {"role": "assistant", "content": "SELECT avg(velocity) FROM flight WHERE pilot  =  'Thompson'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the building, room number, semester and year of courses in the Psychology department, sorted using course title?"}, {"role": "assistant", "content": "SELECT T2.building ,  T2.room_number ,  T2.semester ,  T2.year FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE T1.dept_name  =  'Psychology' ORDER BY T1.title"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the distinct number of president votes."}, {"role": "assistant", "content": "SELECT count(DISTINCT President_Vote) FROM VOTING_RECORD"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which store has most the customers?"}, {"role": "assistant", "content": "SELECT store_id FROM customer GROUP BY store_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all wines produced in 2008."}, {"role": "assistant", "content": "SELECT Name FROM WINE WHERE YEAR  =  \"2008\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of products that were never ordered."}, {"role": "assistant", "content": "SELECT count(*) FROM products WHERE product_id NOT IN ( SELECT product_id FROM Order_items )"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total amount of money spent by Lucas Mancini?"}, {"role": "assistant", "content": "SELECT sum(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T1.id = T2.customer_id WHERE T1.first_name = \"Lucas\" AND T1.last_name = \"Mancini\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the countries that have managers of age above 50 or below 46."}, {"role": "assistant", "content": "SELECT Country FROM manager WHERE Age  >  50 OR Age  <  46"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show card type codes with at least 5 cards."}, {"role": "assistant", "content": "SELECT card_type_code FROM Customers_cards GROUP BY card_type_code HAVING count(*)  >=  5"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many type of jobs do they have?"}, {"role": "assistant", "content": "SELECT count(DISTINCT job) FROM Person"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of members and the location of the performances they attended."}, {"role": "assistant", "content": "SELECT T2.Name ,  T3.Location FROM member_attendance AS T1 JOIN member AS T2 ON T1.Member_ID  =  T2.Member_ID JOIN performance AS T3 ON T1.Performance_ID  =  T3.Performance_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of all left-footed players who have overall rating between 85 and 90."}, {"role": "assistant", "content": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.preferred_foot  =  \"left\" AND T2.overall_rating  >=  85 AND T2.overall_rating  <=  90"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the register ids of electoral registries that have the cross reference source system code 'Electoral' or 'Tax'?"}, {"role": "assistant", "content": "SELECT T1.electoral_register_id FROM Electoral_Register AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id WHERE T2.source_system_code  =  'Electoral' OR T2.source_system_code  =  'Tax'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the description of the marketing region China?"}, {"role": "assistant", "content": "SELECT Marketing_Region_Descriptrion FROM Marketing_Regions WHERE Marketing_Region_Name  =  \"China\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different names for each station that has ever had 7 bikes available?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  =  7"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show project ids and the number of documents in each project."}, {"role": "assistant", "content": "SELECT project_id ,  count(*) FROM Documents GROUP BY project_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the types of film market estimations in year 1995?"}, {"role": "assistant", "content": "SELECT TYPE FROM film_market_estimation WHERE YEAR  =  1995"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which skill is used in fixing the most number of faults? List the skill id and description."}, {"role": "assistant", "content": "SELECT T1.skill_id ,  T1.skill_description FROM Skills AS T1 JOIN Skills_Required_To_Fix AS T2 ON T1.skill_id  =  T2.skill_id GROUP BY T1.skill_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the ship with the largest tonnage?"}, {"role": "assistant", "content": "SELECT Name FROM ship ORDER BY Tonnage DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the state names and the number of customers living in each state."}, {"role": "assistant", "content": "SELECT t2.state_province_county ,  count(*) FROM customer_addresses AS t1 JOIN addresses AS t2 ON t1.address_id  =  t2.address_id GROUP BY t2.state_province_county"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which party had the most hosts? Give me the party location."}, {"role": "assistant", "content": "SELECT LOCATION FROM party ORDER BY Number_of_hosts DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the product with the highest price?"}, {"role": "assistant", "content": "SELECT Product_Name FROM Products ORDER BY Product_Price DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of tracks that are of the media type \"AAC audio file\"."}, {"role": "assistant", "content": "SELECT COUNT(*) FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId WHERE T1.Name  =  \"AAC audio file\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the countries that have both perpetrators with injures more than 50 and perpetrators with injures smaller than 20."}, {"role": "assistant", "content": "SELECT Country FROM perpetrator WHERE Injured  >  50 INTERSECT SELECT Country FROM perpetrator WHERE Injured  <  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name, nationality and id of all male architects ordered by their names lexicographically."}, {"role": "assistant", "content": "SELECT name ,  nationality ,  id FROM architect WHERE gender  =  'male' ORDER BY name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the top 10 customers by total gross sales. List customers' first and last name and total gross sales."}, {"role": "assistant", "content": "SELECT T1.first_name ,  T1.last_name ,  SUM(T2.total) FROM customers AS T1 JOIN invoices AS T2 ON T2.customer_id  =  T1.id GROUP BY T1.id ORDER BY SUM(T2.total) DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and account balances for customers who have taken a total amount of more than 5000 in loans?"}, {"role": "assistant", "content": "SELECT T1.cust_name ,  T1.acc_type FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name HAVING sum(T2.amount)  >  5000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average and maximum damage in millions for storms that had a max speed over 1000?"}, {"role": "assistant", "content": "SELECT avg(damage_millions_USD) ,  max(damage_millions_USD) FROM storm WHERE max_speed  >  1000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of products that are in at least two events in ascending alphabetical order of product name."}, {"role": "assistant", "content": "SELECT T1.Product_Name FROM Products AS T1 JOIN Products_in_Events AS T2 ON T1.Product_ID  =  T2.Product_ID GROUP BY T1.Product_Name HAVING COUNT(*)  >=  2 ORDER BY T1.Product_Name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the first names and last names of customers without any account."}, {"role": "assistant", "content": "SELECT customer_first_name ,  customer_last_name FROM Customers EXCEPT SELECT T1.customer_first_name ,  T1.customer_last_name FROM Customers AS T1 JOIN Accounts AS T2 ON T1.customer_id  =  T2.customer_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many patients are not using Procrastin-X as medication?"}, {"role": "assistant", "content": "SELECT count(*) FROM patient WHERE SSN NOT IN ( SELECT T1.patient FROM Prescribes AS T1 JOIN Medication AS T2 ON T1.Medication  =  T2.Code WHERE T2.name  =  'Procrastin-X' )"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many video game types exist?"}, {"role": "assistant", "content": "SELECT count(DISTINCT gtype) FROM Video_games"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of students taught by the teacher KAWA GORDON."}, {"role": "assistant", "content": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"KAWA\" AND T2.lastname  =  \"GORDON\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the names of cities, ordered alphabetically."}, {"role": "assistant", "content": "SELECT Name FROM city ORDER BY Name ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the source user with the highest average trust score."}, {"role": "assistant", "content": "SELECT T1.name FROM useracct AS T1 JOIN trust AS T2 ON T1.u_id  =  T2.source_u_id GROUP BY T2.source_u_id ORDER BY avg(trust) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the famous titles for artists that have volumes that lasted more than 2 weeks on top."}, {"role": "assistant", "content": "SELECT T1.Famous_Title FROM artist AS T1 JOIN volume AS T2 ON T1.Artist_ID  =  T2.Artist_ID WHERE T2.Weeks_on_Top  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the season, home team, away team of all the games."}, {"role": "assistant", "content": "SELECT season ,  home_team ,  away_team FROM game"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all reviewers that have rated 3 or more movies?"}, {"role": "assistant", "content": "SELECT T2.name FROM Rating AS T1 JOIN Reviewer AS T2 ON T1.rID  =  T2.rID GROUP BY T1.rID HAVING COUNT(*)  >=  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and email for the users who have more than one follower."}, {"role": "assistant", "content": "SELECT T1.name ,  T1.email FROM user_profiles AS T1 JOIN follows AS T2 ON T1.uid  =  T2.f1 GROUP BY T2.f1 HAVING count(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name of all customers sorted by their account balance in ascending order."}, {"role": "assistant", "content": "SELECT cust_name FROM customer ORDER BY acc_bal"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the id of students who registered courses or attended courses?"}, {"role": "assistant", "content": "SELECT student_id FROM student_course_registrations UNION SELECT student_id FROM student_course_attendance"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the details of the top 3 most expensive hotels."}, {"role": "assistant", "content": "SELECT other_hotel_details FROM HOTELS ORDER BY price_range DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name and major of the students who are not allegry to soy."}, {"role": "assistant", "content": "SELECT fname ,  major FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_allergy WHERE Allergy  =  \"Soy\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id and number of shops for the company that produces the most expensive furniture."}, {"role": "assistant", "content": "SELECT t1.manufacturer_id ,  t1.num_of_shops FROM manufacturer AS t1 JOIN furniture_manufacte AS t2 ON t1.manufacturer_id  =  t2.manufacturer_id ORDER BY t2.Price_in_Dollar DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For every medicine id, what are the names of the medicines that can interact with more than one enzyme?"}, {"role": "assistant", "content": "SELECT T1.id ,  T1.Name FROM medicine AS T1 JOIN medicine_enzyme_interaction AS T2 ON T2.medicine_id  =  T1.id GROUP BY T1.id HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of all vehicles?"}, {"role": "assistant", "content": "SELECT vehicle_id FROM Vehicles;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id and star rating of each hotel and sort them in increasing order of price."}, {"role": "assistant", "content": "SELECT hotel_id ,  star_rating_code FROM HOTELS ORDER BY price_range ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of all the customers in alphabetical order."}, {"role": "assistant", "content": "SELECT customer_details FROM customers ORDER BY customer_details"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of the stations in San Francisco that normally have more than 10 bikes available?"}, {"role": "assistant", "content": "SELECT id FROM station WHERE city  =  \"San Francisco\" INTERSECT SELECT station_id FROM status GROUP BY station_id HAVING avg(bikes_available)  >  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the flight number and distance of the flight with maximum price."}, {"role": "assistant", "content": "SELECT flno ,  distance FROM Flight ORDER BY price DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the transaction type that has processed the greatest total amount in transactions?"}, {"role": "assistant", "content": "SELECT transaction_type FROM Financial_transactions GROUP BY transaction_type ORDER BY sum(transaction_amount) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and job title of the staff who was assigned the latest?"}, {"role": "assistant", "content": "SELECT T1.staff_name ,  T2.job_title_code FROM staff AS T1 JOIN staff_department_assignments AS T2 ON T1.staff_id  =  T2.staff_id ORDER BY T2.date_assigned_to DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the order date of each booking?"}, {"role": "assistant", "content": "SELECT Order_Date FROM BOOKINGS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the dorm that does not have a TV Lounge?"}, {"role": "assistant", "content": "SELECT dorm_name FROM dorm EXCEPT SELECT T1.dorm_name FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid WHERE T3.amenity_name  =  'TV Lounge'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all instructors whose salary is greater than the salary of all instructors in the Biology department."}, {"role": "assistant", "content": "SELECT name FROM instructor WHERE salary  >  (SELECT max(salary) FROM instructor WHERE dept_name  =  'Biology')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What address was the document with id 4 mailed to?"}, {"role": "assistant", "content": "SELECT Addresses.address_details FROM Addresses JOIN Documents_Mailed ON Documents_Mailed.mailed_to_address_id = Addresses.address_id WHERE document_id = 4;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show names of actors that have appeared in musical with name \"The Phantom of the Opera\"."}, {"role": "assistant", "content": "SELECT T1.Name FROM actor AS T1 JOIN musical AS T2 ON T1.Musical_ID  =  T2.Musical_ID WHERE T2.Name  =  \"The Phantom of the Opera\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of states that have some college students playing in the mid position but not in the goalie position."}, {"role": "assistant", "content": "SELECT T1.state FROM college AS T1 JOIN tryout AS T2 ON T1.cName  =  T2.cName WHERE T2.pPos  =  'mid' EXCEPT SELECT T1.state FROM college AS T1 JOIN tryout AS T2 ON T1.cName  =  T2.cName WHERE T2.pPos  =  'goalie'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all the subjects."}, {"role": "assistant", "content": "SELECT subject_name FROM SUBJECTS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first names of all instructors who have taught some course and the course code."}, {"role": "assistant", "content": "SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name of the professor who is teaching two courses with code CIS-220 and QM-261."}, {"role": "assistant", "content": "SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'CIS-220' INTERSECT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'QM-261'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the different artists that have produced a song in English but have never receieved a rating higher than 8?"}, {"role": "assistant", "content": "SELECT DISTINCT artist_name FROM song WHERE languages  =  \"english\" EXCEPT SELECT DISTINCT artist_name FROM song WHERE rating  >  8"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show storm name with at least two regions and 10 cities affected."}, {"role": "assistant", "content": "SELECT T1.name FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id HAVING count(*)  >=  2 INTERSECT SELECT T1.name FROM storm AS T1 JOIN affected_region AS T2 ON T1.storm_id  =  T2.storm_id GROUP BY T1.storm_id HAVING sum(T2.number_city_affected)  >=  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the maximum, minimum, and average booked count for the products booked?"}, {"role": "assistant", "content": "SELECT max(booked_count) ,  min(booked_count) ,  avg(booked_count) FROM products_booked"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What parties have at least three representatives?"}, {"role": "assistant", "content": "SELECT Party FROM representative GROUP BY Party HAVING COUNT(*)  >=  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the employees who have not showed up in any circulation history of documents. List the employee's name."}, {"role": "assistant", "content": "SELECT employee_name FROM Employees EXCEPT SELECT Employees.employee_name FROM Employees JOIN Circulation_History ON Circulation_History.employee_id = Employees.employee_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of accounts whose checking balance is higher than corresponding saving balance."}, {"role": "assistant", "content": "SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T2.balance  >  T3.balance"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the description for the budget type with code ORG?"}, {"role": "assistant", "content": "SELECT budget_type_description FROM Ref_budget_codes WHERE budget_type_code  =  \"ORG\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of products that are in at least two events."}, {"role": "assistant", "content": "SELECT T1.Product_Name FROM Products AS T1 JOIN Products_in_Events AS T2 ON T1.Product_ID  =  T2.Product_ID GROUP BY T1.Product_Name HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all the activity names and the number of faculty involved in each activity."}, {"role": "assistant", "content": "SELECT T1.activity_name ,  count(*) FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names and phone numbers of customers living in California state."}, {"role": "assistant", "content": "SELECT t1.customer_name ,  t1.customer_phone FROM customers AS t1 JOIN customer_addresses AS t2 ON t1.customer_id  =  t2.customer_id JOIN addresses AS t3 ON t2.address_id  =  t3.address_id WHERE t3.state_province_county  =  'California'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which customers have used the service named \"Close a policy\" or \"Upgrade a policy\"? Give me the customer names."}, {"role": "assistant", "content": "SELECT t1.customer_name FROM customers AS t1 JOIN first_notification_of_loss AS t2 ON t1.customer_id  =  t2.customer_id JOIN services AS t3 ON t2.service_id  =  t3.service_id WHERE t3.service_name  =  \"Close a policy\" OR t3.service_name  =  \"Upgrade a policy\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different pilot names who had piloted a flight in the country 'United States' or in the airport named 'Billund Airport'?"}, {"role": "assistant", "content": "SELECT DISTINCT T2.pilot FROM airport AS T1 JOIN flight AS T2 ON T1.id  =  T2.airport_id WHERE T1.country  =  'United States' OR T1.name  =  'Billund Airport'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the campuses in Los Angeles county."}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE county  =  \"Los Angeles\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many climbers are from each country?"}, {"role": "assistant", "content": "SELECT Country ,  COUNT(*) FROM climber GROUP BY Country"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the day Number and date of all the documents?"}, {"role": "assistant", "content": "SELECT T2.day_Number ,  T1.Date_Stored FROM All_documents AS T1 JOIN Ref_calendar AS T2 ON T1.date_stored  =  T2.calendar_date"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the songs without a lead vocal?"}, {"role": "assistant", "content": "SELECT DISTINCT title FROM vocals AS t1 JOIN songs AS t2 ON t1.songid  =  t2.songid EXCEPT SELECT t2.title FROM vocals AS t1 JOIN songs AS t2 ON t1.songid  =  t2.songid WHERE TYPE  =  \"lead\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who is the youngest employee in the company? List employee's first and last name."}, {"role": "assistant", "content": "SELECT first_name , last_name FROM employees ORDER BY birth_date DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the birthdays of people in ascending order of height?"}, {"role": "assistant", "content": "SELECT Birth_Date FROM People ORDER BY Height ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of distinct courses that have enrolled students."}, {"role": "assistant", "content": "SELECT count(course_id) FROM Student_Course_Enrolment"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the schools with some players in the mid position but no goalies?"}, {"role": "assistant", "content": "SELECT cName FROM  tryout WHERE pPos  =  'mid' EXCEPT SELECT cName FROM  tryout WHERE pPos  =  'goalie'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the first names of all the students in room 107."}, {"role": "assistant", "content": "SELECT DISTINCT firstname FROM list WHERE classroom  =  107"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How much did the the player with first name Len and last name Barker earn between 1985 to 1990 in total?"}, {"role": "assistant", "content": "SELECT sum(T1.salary) FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id WHERE T2.name_first  =  'Len' AND T2.name_last = 'Barker' AND T1.year BETWEEN 1985 AND 1990;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the customers who have at most two orders."}, {"role": "assistant", "content": "SELECT T2.customer_name FROM orders AS T1 JOIN customers AS T2 ON T1.customer_id = T2.customer_id GROUP BY T2.customer_id HAVING count(*)  <=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all budget type codes and descriptions."}, {"role": "assistant", "content": "SELECT budget_type_code ,  budget_type_description FROM Ref_budget_codes"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of all distinct nurses ordered by alphabetical order?"}, {"role": "assistant", "content": "SELECT DISTINCT name FROM nurse ORDER BY name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the student ID and personal name of the student with at least two enrollments."}, {"role": "assistant", "content": "SELECT T1.student_id ,  T2.personal_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the ids of the employees who don't authorize destruction for any document."}, {"role": "assistant", "content": "SELECT employee_id FROM Employees EXCEPT SELECT Destruction_Authorised_by_Employee_ID FROM Documents_to_be_destroyed"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the campuses that is in Northridge, Los Angeles or in San Francisco, San Francisco."}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE LOCATION  =  \"Northridge\" AND county  =  \"Los Angeles\" UNION SELECT campus FROM campuses WHERE LOCATION  =  \"San Francisco\" AND county  =  \"San Francisco\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all the players who received a yes during tryouts, and also what are the names of their colleges?"}, {"role": "assistant", "content": "SELECT T1.pName ,  T2.cName FROM player AS T1 JOIN tryout AS T2 ON T1.pID  =  T2.pID WHERE T2.decision  =  'yes'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and email of the user whose name contains the word \u2018Swift\u2019."}, {"role": "assistant", "content": "SELECT name ,  email FROM user_profiles WHERE name LIKE '%Swift%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the total number of scientists."}, {"role": "assistant", "content": "SELECT count(*) FROM scientists"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last names of teachers teaching in classroom 109."}, {"role": "assistant", "content": "SELECT lastname FROM teachers WHERE classroom  =  109"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each Orange county campus, report the number of degrees granted after 2000."}, {"role": "assistant", "content": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T1.county  =  \"Orange\" AND T2.year  >=  2000 GROUP BY T1.campus"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all ministers who do not belong to Progress Party."}, {"role": "assistant", "content": "SELECT minister FROM party WHERE party_name != 'Progress Party'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of all reviewers who have not given 4 stars at least once?"}, {"role": "assistant", "content": "SELECT rID FROM Rating WHERE stars != 4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different users wrote some reviews?"}, {"role": "assistant", "content": "SELECT count(DISTINCT u_id) FROM review"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many products are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM Products"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who are the top 3 players in terms of overall rating?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id  =  T2.player_api_id ORDER BY overall_rating DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Please give me a list of cities whose regional population is over 8000000 or under 5000000."}, {"role": "assistant", "content": "SELECT city FROM city WHERE regional_population  >  10000000 UNION SELECT city FROM city WHERE regional_population  <  5000000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct secretary votes in the fall election cycle?"}, {"role": "assistant", "content": "SELECT DISTINCT Secretary_Vote FROM VOTING_RECORD WHERE ELECTION_CYCLE  =  \"Fall\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many vocal types are used in the song \"Le Pop\"?"}, {"role": "assistant", "content": "SELECT count(*) FROM vocals AS T1 JOIN songs AS T2 ON T1.songid  =  T2.songid WHERE title  =  \"Le Pop\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the ids of the three products purchased in the largest amounts."}, {"role": "assistant", "content": "SELECT product_id FROM product_suppliers ORDER BY total_amount_purchased DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which 3 players won the most player awards? List their full name and id."}, {"role": "assistant", "content": "SELECT T1.name_first ,  T1.name_last ,  T1.player_id FROM player AS T1 JOIN player_award AS T2 ON T1.player_id  =  T2.player_id GROUP BY T1.player_id ORDER BY count(*) DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the average rating and resolution of songs that are in Bangla?"}, {"role": "assistant", "content": "SELECT avg(rating) ,  avg(resolution) FROM song WHERE languages  =  \"bangla\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average weight of all players?"}, {"role": "assistant", "content": "SELECT avg(weight) FROM Player"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the three artists who have produced the most songs, and how many works did they produce?"}, {"role": "assistant", "content": "SELECT T1.artist_name ,  count(*) FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name GROUP BY T2.artist_name ORDER BY count(*) DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name and phone number of all suppliers in the alphabetical order of their addresses."}, {"role": "assistant", "content": "SELECT T1.supplier_name ,  T1.supplier_phone FROM Suppliers AS T1 JOIN supplier_addresses AS T2 ON T1.supplier_id  =  T2.supplier_id JOIN addresses AS T3 ON T2.address_id  =  T3.address_id ORDER BY T3.address_details"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of parties."}, {"role": "assistant", "content": "SELECT count(*) FROM party"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each position, what is the minimum time students spent practicing?"}, {"role": "assistant", "content": "SELECT min(T2.HS) ,   T1.pPos FROM tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID GROUP BY T1.pPos"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the deparment with the highest enrollment?"}, {"role": "assistant", "content": "SELECT dept_name FROM student GROUP BY dept_name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the last names and ids of all drivers who had 11 pit stops and participated in more than 5 races?"}, {"role": "assistant", "content": "SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  =  11 INTERSECT SELECT T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the color description that is least common across products."}, {"role": "assistant", "content": "SELECT t2.color_description FROM products AS t1 JOIN ref_colors AS t2 ON t1.color_code  =  t2.color_code GROUP BY t2.color_description ORDER BY count(*) ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What campuses are located in the county of Los Angeles?"}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE county  =  \"Los Angeles\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What instrument did the musician with last name \"Heilo\" use in the song \"Badlands\"?"}, {"role": "assistant", "content": "SELECT T4.instrument FROM Performance AS T1 JOIN Band AS T2 ON T1.bandmate  =  T2.id JOIN Songs AS T3 ON T3.SongId  =  T1.SongId JOIN Instruments AS T4 ON T4.songid  =  T3.songid AND T4.bandmateid  =  T2.id WHERE T2.lastname  =  \"Heilo\" AND T3.title  =  \"Badlands\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the three countries that the least players are from?"}, {"role": "assistant", "content": "SELECT birth_country FROM player GROUP BY birth_country ORDER BY count(*) ASC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the location and all games score of the school that has Clemson as its team name."}, {"role": "assistant", "content": "SELECT t2.All_Games ,  t1.location FROM university AS t1 JOIN basketball_match AS t2 ON t1.school_id  =  t2.school_id WHERE team_name  =  'Clemson'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is zip code of customer with first name as Carole and last name as Bernhard?"}, {"role": "assistant", "content": "SELECT T2.zip_postcode FROM Customers AS T1 JOIN Addresses AS T2 ON T1.customer_address_id = T2.address_id WHERE T1.first_name = \"Carole\" AND T1.last_name = \"Bernhard\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What student id corresponds to the oldest student?"}, {"role": "assistant", "content": "SELECT StuID FROM Student WHERE age  =  (SELECT max(age) FROM Student)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the classes of races that have two or more corresponding races?"}, {"role": "assistant", "content": "SELECT CLASS FROM race GROUP BY CLASS HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the code of city where most of students are living in."}, {"role": "assistant", "content": "SELECT city_code FROM student GROUP BY city_code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different ids and names of the stations that have had more than 12 bikes available?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.id ,  T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  >  12"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show customer ids who don't have an account."}, {"role": "assistant", "content": "SELECT customer_id FROM Customers EXCEPT SELECT customer_id FROM Accounts"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of managers in ascending order of level?"}, {"role": "assistant", "content": "SELECT Name FROM manager ORDER BY LEVEL ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all ministers and parties they belong to in descending order of the time they took office."}, {"role": "assistant", "content": "SELECT minister ,  party_name FROM party ORDER BY took_office DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Where does the staff member with the first name Elsa live?"}, {"role": "assistant", "content": "SELECT T2.address FROM staff AS T1 JOIN address AS T2 ON T1.address_id  =  T2.address_id WHERE T1.first_name  =  'Elsa'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of the candidates that have an outcome code of Pass?"}, {"role": "assistant", "content": "SELECT candidate_id FROM candidate_assessments WHERE asessment_outcome_code = \"Pass\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of films."}, {"role": "assistant", "content": "SELECT count(*) FROM film"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the city and name of bank branches that provide business loans."}, {"role": "assistant", "content": "SELECT T1.bname ,  T1.city FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id WHERE T2.loan_type  =  'Business'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the position that is most common among players in match seasons?"}, {"role": "assistant", "content": "SELECT POSITION FROM match_season GROUP BY POSITION ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many times has the student Linda Smith visited Subway?"}, {"role": "assistant", "content": "SELECT count(*) FROM Student JOIN Visits_Restaurant ON Student.StuID = Visits_Restaurant.StuID JOIN Restaurant ON Visits_Restaurant.ResID = Restaurant.ResID WHERE Student.Fname = \"Linda\" AND Student.Lname = \"Smith\" AND Restaurant.ResName = \"Subway\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all restaurant types."}, {"role": "assistant", "content": "SELECT ResTypeName FROM Restaurant_Type;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of amenities Smith Hall dorm have. ordered the results by amenity names."}, {"role": "assistant", "content": "SELECT T3.amenity_name FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid JOIN dorm_amenity AS T3 ON T2.amenid  =  T3.amenid WHERE T1.dorm_name  =  'Smith Hall' ORDER BY T3.amenity_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and players of all the clubs?"}, {"role": "assistant", "content": "SELECT T1.name ,  T2.Player_id FROM club AS T1 JOIN player AS T2 ON T1.Club_ID  =  T2.Club_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the official names of cities that have not held any competition."}, {"role": "assistant", "content": "SELECT Official_Name FROM city WHERE City_ID NOT IN (SELECT Host_city_ID FROM farm_competition)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all the races that occurred in the year 2017?"}, {"role": "assistant", "content": "SELECT name FROM races WHERE YEAR = 2017"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the dates when customers with ids between 10 and 20 became customers?"}, {"role": "assistant", "content": "SELECT date_became_customer FROM customers WHERE customer_id BETWEEN 10 AND 20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many video games have type Massively multiplayer online game?"}, {"role": "assistant", "content": "SELECT count(*) FROM Video_games WHERE gtype  =  \"Massively multiplayer online game\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all product names and the total quantity ordered for each product name."}, {"role": "assistant", "content": "SELECT T2.product_name ,  sum(T1.product_quantity) FROM Order_items AS T1 JOIN Products AS T2 ON T1.product_id  =  T2.product_id GROUP BY T2.product_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of instructors who advise more than one student?"}, {"role": "assistant", "content": "SELECT T1.name FROM instructor AS T1 JOIN advisor AS T2 ON T1.id  =  T2.i_id GROUP BY T2.i_id HAVING count(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the description for the results whose project detail is 'sint'?"}, {"role": "assistant", "content": "SELECT T1.outcome_description FROM Research_outcomes AS T1 JOIN Project_outcomes AS T2 ON T1.outcome_code  =  T2.outcome_code JOIN Projects AS T3 ON T2.project_id  =  T3.project_id WHERE T3.project_details  =  'sint'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "From which hometowns did both people older than 23 and younger than 20 come from?"}, {"role": "assistant", "content": "SELECT Hometown FROM people WHERE Age  >  23 INTERSECT SELECT Hometown FROM people WHERE Age  <  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the salaray and name of the employee that is certified to fly the most planes?"}, {"role": "assistant", "content": "SELECT T1.name ,  T1.salary FROM Employee AS T1 JOIN Certificate AS T2 ON T1.eid  =  T2.eid GROUP BY T1.eid ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first names of all employees that are professors ordered by date of birth?"}, {"role": "assistant", "content": "SELECT emp_fname FROM employee WHERE emp_jobcode  =  'PROF' ORDER BY emp_dob"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of all customers."}, {"role": "assistant", "content": "SELECT customer_name FROM customers"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many distinct official languages are there among countries of players whose positions are defenders."}, {"role": "assistant", "content": "SELECT count(DISTINCT T1.Official_native_language) FROM country AS T1 JOIN match_season AS T2 ON T1.Country_id  =  T2.Country WHERE T2.Position  =  \"Defender\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and total checking and savings balance of the accounts whose savings balance is lower than corresponding checking balance."}, {"role": "assistant", "content": "SELECT T1.name ,  T3.balance + T2.balance FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid JOIN savings AS T3 ON T1.custid  =  T3.custid WHERE T3.balance  <  T2.balance"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the details of the car with id 1?"}, {"role": "assistant", "content": "SELECT vehicle_details FROM Vehicles WHERE vehicle_id = 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the maximum, minimum and average number of used kb in screen mode."}, {"role": "assistant", "content": "SELECT max(used_kb) , min(used_kb) , avg(used_kb) FROM screen_mode;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name of film studio that have the most number of films."}, {"role": "assistant", "content": "SELECT Studio FROM film GROUP BY Studio ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the enrollment and primary conference for the university which was founded the earliest?"}, {"role": "assistant", "content": "SELECT enrollment ,  primary_conference FROM university ORDER BY founded LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the full name (first and last name), and salary for those employees who earn below 6000."}, {"role": "assistant", "content": "SELECT first_name ,  last_name ,  salary FROM employees WHERE salary  <  6000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many events had participants whose details had the substring 'Dr.'"}, {"role": "assistant", "content": "SELECT count(*) FROM participants AS T1 JOIN Participants_in_Events AS T2 ON T1.Participant_ID  =  T2.Participant_ID WHERE T1.participant_details LIKE '%Dr.%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which customers have an insurance policy with the type code \"Deputy\" or \"Uniform\"? Return the customer details."}, {"role": "assistant", "content": "SELECT DISTINCT t2.customer_details FROM policies AS t1 JOIN customers AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.policy_type_code  =  \"Deputy\" OR t1.policy_type_code  =  \"Uniform\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all card type codes."}, {"role": "assistant", "content": "SELECT DISTINCT card_type_code FROM Customers_Cards"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the detail of the location UK Gallery?"}, {"role": "assistant", "content": "SELECT Other_Details FROM LOCATIONS WHERE Location_Name  =  \"UK Gallery\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the titles and directors of the movies whose star is greater than the average stars of the movies directed by James Cameron?"}, {"role": "assistant", "content": "SELECT T2.title ,  T2.director FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID WHERE T1.stars  >  (SELECT avg(T1.stars) FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID WHERE T2.director  =  \"James Cameron\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "return all columns of the albums created in the year of 2012."}, {"role": "assistant", "content": "SELECT * FROM Albums WHERE YEAR  =  2012"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Please list the age and famous title of artists in descending order of age."}, {"role": "assistant", "content": "SELECT Famous_Title ,  Age FROM artist ORDER BY Age DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which channels are not owned by CCTV? Give me the channel names."}, {"role": "assistant", "content": "SELECT name FROM channel WHERE OWNER != 'CCTV'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the phone numbers for each employee?"}, {"role": "assistant", "content": "SELECT Phone FROM EMPLOYEE"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the order dates of all the bookings."}, {"role": "assistant", "content": "SELECT Order_Date FROM BOOKINGS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the description and code of the service type that is performed the most times."}, {"role": "assistant", "content": "SELECT T1.Service_Type_Description , T1.Service_Type_Code FROM Ref_Service_Types AS T1 JOIN Services AS T2 ON T1.Service_Type_Code  =  T2.Service_Type_Code GROUP BY T1.Service_Type_Code ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Report the distinct advisors who have more than 2 students."}, {"role": "assistant", "content": "SELECT Advisor FROM STUDENT GROUP BY Advisor HAVING count(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many students are in each department?"}, {"role": "assistant", "content": "SELECT count(*) ,  dept_code FROM student GROUP BY dept_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customers are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM Customers;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What campus had more than 400 total enrollment but more than 200 full time enrollment in year 1956?"}, {"role": "assistant", "content": "SELECT T1.campus FROM campuses AS t1 JOIN enrollments AS t2 ON t1.id  =  t2.campus WHERE t2.year  =  1956 AND totalenrollment_ay  >  400 AND FTE_AY  >  200"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all reviewers who rated Gone with the Wind."}, {"role": "assistant", "content": "SELECT DISTINCT T3.name FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID JOIN Reviewer AS T3 ON T1.rID  =  T3.rID WHERE T2.title  =  'Gone with the Wind'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the name of aircrafts with top three lowest distances."}, {"role": "assistant", "content": "SELECT name FROM Aircraft ORDER BY distance LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which countries has the most number of airlines whose active status is 'Y'?"}, {"role": "assistant", "content": "SELECT country FROM airlines WHERE active  =  'Y' GROUP BY country ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name, city, and country of the airport with the highest elevation?"}, {"role": "assistant", "content": "SELECT name ,  city ,  country FROM airports ORDER BY elevation DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the joined year of the pilot of the highest rank?"}, {"role": "assistant", "content": "SELECT Join_Year FROM pilot ORDER BY Rank ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the total number of available hotels."}, {"role": "assistant", "content": "SELECT count(*) FROM HOTELS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show company name and main industry without a gas station."}, {"role": "assistant", "content": "SELECT company ,  main_industry FROM company WHERE company_id NOT IN (SELECT company_id FROM station_company)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of people that are on affirmative side of debates with number of audience bigger than 200."}, {"role": "assistant", "content": "SELECT T3.Name FROM debate_people AS T1 JOIN debate AS T2 ON T1.Debate_ID  =  T2.Debate_ID JOIN people AS T3 ON T1.Affirmative  =  T3.People_ID WHERE T2.Num_of_Audience  >  200"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find courses that ran in Fall 2009 but not in Spring 2010."}, {"role": "assistant", "content": "SELECT course_id FROM SECTION WHERE semester  =  'Fall' AND YEAR  =  2009 EXCEPT SELECT course_id FROM SECTION WHERE semester  =  'Spring' AND YEAR  =  2010"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids for all sporty students who are on scholarship?"}, {"role": "assistant", "content": "SELECT StuID FROM Sportsinfo WHERE onscholarship  =  'Y'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find papers whose second author has last name \"Turon\" and is affiliated with an institution in the country \"USA\"."}, {"role": "assistant", "content": "SELECT t3.title FROM authors AS t1 JOIN authorship AS t2 ON t1.authid  =  t2.authid JOIN papers AS t3 ON t2.paperid  =  t3.paperid JOIN inst AS t4 ON t2.instid  =  t4.instid WHERE t4.country  =  \"USA\" AND t2.authorder  =  2 AND t1.lname  =  \"Turon\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the phones and emails of workshop groups in which services are performed?"}, {"role": "assistant", "content": "SELECT T1.Store_Phone ,  T1.Store_Email_Address FROM Drama_Workshop_Groups AS T1 JOIN Services AS T2 ON T1.Workshop_Group_ID  =  T2.Workshop_Group_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the studios that have not produced films with director \"Walter Hill\"."}, {"role": "assistant", "content": "SELECT Studio FROM film EXCEPT SELECT Studio FROM film WHERE Director  =  \"Walter Hill\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the customer who made an order most recently."}, {"role": "assistant", "content": "SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id ORDER BY t2.order_date DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "IN which year did city \"Taizhou ( Zhejiang )\" serve as a host city?"}, {"role": "assistant", "content": "SELECT T2.year FROM city AS T1 JOIN hosting_city AS T2 ON T1.city_id  =  T2.host_city WHERE T1.city  =  \"Taizhou ( Zhejiang )\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the year which offers the largest number of courses."}, {"role": "assistant", "content": "SELECT YEAR FROM SECTION GROUP BY YEAR ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the renting arrears tax ids related to the customer master index whose detail is not 'Schmidt, Kertzmann and Lubowitz'?"}, {"role": "assistant", "content": "SELECT T1.council_tax_id FROM Rent_Arrears AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id JOIN Customer_Master_Index AS T3 ON T3.master_customer_id  =  T2.master_customer_id WHERE T3.cmi_details != 'Schmidt ,  Kertzmann and Lubowitz'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which state can address \"6862 Kaitlyn Knolls\" possibly be in?"}, {"role": "assistant", "content": "SELECT state_province_county FROM addresses WHERE line_1_number_building LIKE \"%6862 Kaitlyn Knolls%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of routes whose destinations are Italian airports?"}, {"role": "assistant", "content": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Report all majors that have less than 3 students."}, {"role": "assistant", "content": "SELECT Major FROM STUDENT GROUP BY Major HAVING COUNT(*)  <  3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average latitude and longitude of stations located in San Jose city?"}, {"role": "assistant", "content": "SELECT avg(lat) ,  avg(long) FROM station WHERE city  =  \"San Jose\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the total points for all gymnasts, ordered by total points descending?"}, {"role": "assistant", "content": "SELECT Total_Points FROM gymnast ORDER BY Total_Points DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the authors who do not have submission to any workshop."}, {"role": "assistant", "content": "SELECT Author FROM submission WHERE Submission_ID NOT IN (SELECT Submission_ID FROM acceptance)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all distinct lot details."}, {"role": "assistant", "content": "SELECT DISTINCT lot_details FROM LOTS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first and last names of the 5 customers who purchased something most recently?"}, {"role": "assistant", "content": "SELECT T1.first_name ,  T1.last_name FROM customers AS T1 JOIN invoices AS T2 ON T2.customer_id  =  T1.id ORDER BY T2.invoice_date DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of players coached by the rank 1 coach."}, {"role": "assistant", "content": "SELECT T3.Player_name FROM player_coach AS T1 JOIN coach AS T2 ON T1.Coach_ID  =  T2.Coach_ID JOIN player AS T3 ON T1.Player_ID  =  T3.Player_ID WHERE T2.Rank  =  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the aircraft name for the flight with number 99"}, {"role": "assistant", "content": "SELECT T2.name FROM Flight AS T1 JOIN Aircraft AS T2 ON T1.aid  =  T2.aid WHERE T1.flno  =  99"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which authors have written a paper with title containing the word \"Monadic\"? Return their last names."}, {"role": "assistant", "content": "SELECT t1.lname FROM authors AS t1 JOIN authorship AS t2 ON t1.authid  =  t2.authid JOIN papers AS t3 ON t2.paperid  =  t3.paperid WHERE t3.title LIKE \"%Monadic%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show first name, last name, age for all female students. Their sex is F."}, {"role": "assistant", "content": "SELECT Fname ,  Lname ,  Age FROM Student WHERE Sex  =  'F'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many calendar items do we have?"}, {"role": "assistant", "content": "SELECT count(*) FROM Ref_calendar"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the number of accounts."}, {"role": "assistant", "content": "SELECT count(*) FROM Accounts"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first and last name of all biology professors?"}, {"role": "assistant", "content": "SELECT T3.EMP_FNAME ,  T3.EMP_LNAME FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code JOIN employee AS T3 ON T1.EMP_NUM  =  T3.EMP_NUM WHERE DEPT_NAME  =  \"Biology\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the reign and days held of wrestlers."}, {"role": "assistant", "content": "SELECT Reign ,  Days_held FROM wrestler"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the average age of students who live in the city with code \"NYC\" and have secretary votes in the spring election cycle."}, {"role": "assistant", "content": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many female people are older than 30 in our record?"}, {"role": "assistant", "content": "SELECT count(*) FROM people WHERE is_male  =  'F' AND age  >  30"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which city has the lowest GDP? Please list the city name and its GDP."}, {"role": "assistant", "content": "SELECT city ,  GDP FROM city ORDER BY GDP LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all clubs that do not have any players?"}, {"role": "assistant", "content": "SELECT name FROM CLub WHERE Club_ID NOT IN (SELECT Club_ID FROM player)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which film has the most copies in the inventory? List both title and id."}, {"role": "assistant", "content": "SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different instruments does the musician with the last name \"Heilo\" use?"}, {"role": "assistant", "content": "SELECT count(DISTINCT instrument) FROM instruments AS T1 JOIN Band AS T2 ON T1.bandmateid  =  T2.id WHERE T2.lastname  =  \"Heilo\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many people in total can stay in the modern rooms of this inn?"}, {"role": "assistant", "content": "SELECT sum(maxOccupancy) FROM Rooms WHERE decor  =  'modern';"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id, first name, and last name of the driver who was in the first position for laptime at least twice?"}, {"role": "assistant", "content": "SELECT T1.driverid ,  T1.forename ,  T1.surname FROM drivers AS T1 JOIN laptimes AS T2 ON T1.driverid = T2.driverid WHERE POSITION  =  '1' GROUP BY T1.driverid HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the pilot positions that have both pilots joining after year 2005 and pilots joining before 2000."}, {"role": "assistant", "content": "SELECT POSITION FROM pilot WHERE Join_Year\t <  2000 INTERSECT SELECT POSITION FROM pilot WHERE Join_Year\t >  2005"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "On which days more than one revisions were made on catalogs."}, {"role": "assistant", "content": "SELECT date_of_latest_revision FROM Catalogs GROUP BY date_of_latest_revision HAVING count(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many films are there in each category? List the genre name, genre id and the count."}, {"role": "assistant", "content": "SELECT T2.name ,  T1.category_id ,  count(*) FROM film_category AS T1 JOIN category AS T2 ON T1.category_id  =  T2.category_id GROUP BY T1.category_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the ids and dates of the logs for the problem whose id is 10."}, {"role": "assistant", "content": "SELECT problem_log_id ,  log_entry_date FROM problem_log WHERE problem_id = 10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each director, return the director's name together with the title of the movie they directed that received the highest rating among all of their movies, and the value of that rating. Ignore movies whose director is NULL."}, {"role": "assistant", "content": "SELECT T2.title ,  T1.stars ,  T2.director ,  max(T1.stars) FROM Rating AS T1 JOIN Movie AS T2 ON T1.mID  =  T2.mID WHERE director != \"null\" GROUP BY director"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the players whose names contain letter 'a'."}, {"role": "assistant", "content": "SELECT DISTINCT pName FROM Player WHERE pName LIKE '%a%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which staff have contacted which engineers? List the staff name and the engineer first name and last name."}, {"role": "assistant", "content": "SELECT T1.staff_name ,  T3.first_name ,  T3.last_name FROM Staff AS T1 JOIN Engineer_Visits AS T2 ON T1.staff_id  =  T2.contact_staff_id JOIN Maintenance_Engineers AS T3 ON T2.engineer_id  =  T3.engineer_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of climbers."}, {"role": "assistant", "content": "SELECT count(*) FROM climber"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the songs included in volumes that have more than 1 week on top."}, {"role": "assistant", "content": "SELECT Song FROM volume WHERE Weeks_on_Top  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the sport with the most scholarship students?"}, {"role": "assistant", "content": "SELECT sportname FROM Sportsinfo WHERE onscholarship  =  'Y' GROUP BY sportname ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the unit of measure and category code for the 'chervil' product?"}, {"role": "assistant", "content": "SELECT t2.unit_of_measure ,  t2.product_category_code FROM products AS t1 JOIN ref_product_categories AS t2 ON t1.product_category_code  =  t2.product_category_code WHERE t1.product_name  =  \"chervil\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the customer id, first and last name with least number of accounts."}, {"role": "assistant", "content": "SELECT T1.customer_id ,  T2.customer_first_name ,  T2.customer_last_name FROM Customers_cards AS T1 JOIN Customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the id of the order made most recently."}, {"role": "assistant", "content": "SELECT order_id FROM orders ORDER BY date_order_placed DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many invoices were billed from Chicago, IL?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM invoices WHERE billing_city  =  \"Chicago\" AND billing_state  =  \"IL\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last names of teachers who are not involved in any detention."}, {"role": "assistant", "content": "SELECT last_name FROM Teachers EXCEPT SELECT T1.last_name FROM Teachers AS T1 JOIN Detention AS T2 ON T1.teacher_id  =  T2.teacher_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of customers who have the most mailshots."}, {"role": "assistant", "content": "SELECT T2.customer_name FROM mailshot_customers AS T1 JOIN customers AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of projects that have taken longer than the average number of hours for all projects?"}, {"role": "assistant", "content": "SELECT name FROM projects WHERE hours  >  (SELECT avg(hours) FROM projects)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many available hotels are there in total?"}, {"role": "assistant", "content": "SELECT count(*) FROM HOTELS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the airline with the most routes?"}, {"role": "assistant", "content": "SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each tourist attraction, return its name and the date when the tourists named Vincent or Vivian visited there."}, {"role": "assistant", "content": "SELECT T1.Name ,  T3.Visit_Date FROM Tourist_Attractions AS T1 JOIN VISITORS AS T2 JOIN VISITS AS T3 ON T1.Tourist_Attraction_ID  =  T3.Tourist_Attraction_ID AND T2.Tourist_ID  =  T3.Tourist_ID WHERE T2.Tourist_Details  =  \"Vincent\" OR T2.Tourist_Details  =  \"Vivian\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last name and hire date of the professor who is in office DRE 102."}, {"role": "assistant", "content": "SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all the salary values players received in 2010 and 2001."}, {"role": "assistant", "content": "SELECT salary FROM salary WHERE YEAR  =  2010 UNION SELECT salary FROM salary WHERE YEAR  =  2001"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the investor that has invested in the most number of entrepreneurs?"}, {"role": "assistant", "content": "SELECT Investor FROM entrepreneur GROUP BY Investor ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which students study under the teacher named OTHA MOYER? Give me the first and last names of the students."}, {"role": "assistant", "content": "SELECT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"OTHA\" AND T2.lastname  =  \"MOYER\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the course codes for every class that the student with the last name Smithson took?"}, {"role": "assistant", "content": "SELECT T1.crs_code FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num WHERE T3.stu_lname  =  'Smithson'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the name and id of the team offering the lowest average salary?"}, {"role": "assistant", "content": "SELECT T1.name ,  T1.team_id FROM team AS T1 JOIN salary AS T2 ON T1.team_id = T2.team_id GROUP BY T1.team_id ORDER BY avg(T2.salary) ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the top 3 products which have the largest number of problems?"}, {"role": "assistant", "content": "SELECT T2.product_name FROM problems AS T1 JOIN product AS T2 ON T1.product_id = T2.product_id GROUP BY T2.product_name ORDER BY count(*) DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which grade is studying in classroom 103?"}, {"role": "assistant", "content": "SELECT DISTINCT grade FROM list WHERE classroom  =  103"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of all products that were either ordered more than 3 times or have a cumulative amount purchased of above 80000?"}, {"role": "assistant", "content": "SELECT product_id FROM Order_Items GROUP BY product_id HAVING count(*)  >  3 UNION SELECT product_id FROM Product_Suppliers GROUP BY product_id HAVING sum(total_amount_purchased)  >  80000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the ship that is steered by the youngest captain."}, {"role": "assistant", "content": "SELECT t1.name FROM ship AS t1 JOIN captain AS t2 ON t1.ship_id  =  t2.ship_id ORDER BY t2.age LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show total points of all players."}, {"role": "assistant", "content": "SELECT sum(Points) FROM player"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the tallest building?"}, {"role": "assistant", "content": "SELECT name FROM building ORDER BY height_feet DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the nicknames of schools whose division is not 1?"}, {"role": "assistant", "content": "SELECT Nickname FROM school_details WHERE Division != \"Division 1\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the average total amount purchased and total value purchased for the supplier who supplies the greatest number of products."}, {"role": "assistant", "content": "SELECT avg(total_amount_purchased) ,  avg(total_value_purchased) FROM Product_Suppliers WHERE supplier_id  =  (SELECT supplier_id FROM Product_Suppliers GROUP BY supplier_id ORDER BY count(*) DESC LIMIT 1)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which college has the most authors with submissions?"}, {"role": "assistant", "content": "SELECT College FROM submission GROUP BY College ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the sum of total pounds of purchase in year 2018 for all branches in London?"}, {"role": "assistant", "content": "SELECT sum(total_pounds) FROM purchase AS T1 JOIN branch AS T2 ON T1.branch_id  =  T2.branch_id WHERE T2.city  =  'London' AND T1.year  =  2018"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Where is the club \"Hopkins Student Enterprises\" located?"}, {"role": "assistant", "content": "SELECT clublocation FROM club WHERE clubname  =  \"Hopkins Student Enterprises\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first and last name of artist who performed \"Le Pop\"?"}, {"role": "assistant", "content": "SELECT T2.firstname ,  T2.lastname FROM Performance AS T1 JOIN Band AS T2 ON T1.bandmate  =  T2.id JOIN Songs AS T3 ON T3.SongId  =  T1.SongId WHERE T3.Title  =  \"Le Pop\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the event venues and names that have the top 2 most number of people attended."}, {"role": "assistant", "content": "SELECT venue ,  name FROM event ORDER BY Event_Attendance DESC LIMIT 2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of players who have the best dribbling?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.dribbling  =  ( SELECT max(overall_rating) FROM Player_Attributes)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many professors who has a either Ph.D. or MA degree?"}, {"role": "assistant", "content": "SELECT count(*) FROM professor WHERE prof_high_degree  =  'Ph.D.' OR prof_high_degree  =  'MA'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all characteristics of product named \"sesame\" with type code \"Grade\"."}, {"role": "assistant", "content": "SELECT t3.characteristic_name FROM products AS t1 JOIN product_characteristics AS t2 ON t1.product_id  =  t2.product_id JOIN CHARACTERISTICS AS t3 ON t2.characteristic_id  =  t3.characteristic_id WHERE t1.product_name  =  \"sesame\" AND t3.characteristic_type_code  =  \"Grade\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are names of patients who made an appointment?"}, {"role": "assistant", "content": "SELECT name FROM appointment AS T1 JOIN patient AS T2 ON T1.patient  =  T2.ssn"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of artists that do not have any albums."}, {"role": "assistant", "content": "SELECT Name FROM ARTIST EXCEPT SELECT T2.Name FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistId"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each city, what is the highest latitude for its stations?"}, {"role": "assistant", "content": "SELECT city ,  max(lat) FROM station GROUP BY city"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which papers did the author \"Olin Shivers\" write? Give me the paper titles."}, {"role": "assistant", "content": "SELECT t3.title FROM authors AS t1 JOIN authorship AS t2 ON t1.authid  =  t2.authid JOIN papers AS t3 ON t2.paperid  =  t3.paperid WHERE t1.fname  =  \"Olin\" AND t1.lname  =  \"Shivers\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customers have email that contains \"gmail.com\"?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM CUSTOMER WHERE Email LIKE \"%gmail.com%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me the average and minimum price (in Euro) of the products."}, {"role": "assistant", "content": "SELECT avg(price_in_euros) ,  min(price_in_euros) FROM catalog_contents"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct positions of the players from a country whose capital is Dublin?"}, {"role": "assistant", "content": "SELECT DISTINCT T2.Position FROM country AS T1 JOIN match_season AS T2 ON T1.Country_id  =  T2.Country WHERE T1.Capital  =  \"Dublin\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the id and name of the photos for mountains?"}, {"role": "assistant", "content": "SELECT T1.id ,  T1.name FROM mountain AS T1 JOIN photos AS T2 ON T1.id  =  T2.mountain_id WHERE T1.height  >  4000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of the tryout players who are from the college with largest size."}, {"role": "assistant", "content": "SELECT T2.pName FROM  tryout AS T1 JOIN player AS T2 ON T1.pID  =  T2.pID WHERE T1.cName  =  (SELECT cName FROM college ORDER BY enr DESC LIMIT 1)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many allergy entries are there?"}, {"role": "assistant", "content": "SELECT count(DISTINCT allergy) FROM Allergy_type"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the nationalities and ages of journalists?"}, {"role": "assistant", "content": "SELECT Nationality ,  Age FROM journalist"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the last names of the teachers who teach the student called GELL TAMI?"}, {"role": "assistant", "content": "SELECT T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.firstname  =  \"GELL\" AND T1.lastname  =  \"TAMI\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "return the smallest salary for every departments."}, {"role": "assistant", "content": "SELECT MIN(salary) ,  department_id FROM employees GROUP BY department_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the average quantity of stocks."}, {"role": "assistant", "content": "SELECT avg(Quantity) FROM stock"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all the products whose stock number starts with \"2\"."}, {"role": "assistant", "content": "SELECT catalog_entry_name FROM catalog_contents WHERE product_stock_number LIKE \"2%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of scientists who are not working on the project with the most hours?"}, {"role": "assistant", "content": "SELECT name FROM scientists EXCEPT SELECT T3.name FROM assignedto AS T1 JOIN projects AS T2 ON T1.project  =  T2.code JOIN scientists AS T3 ON T1.scientist  =  T3.SSN WHERE T2.hours  =  (SELECT max(hours) FROM projects)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of distinct projects."}, {"role": "assistant", "content": "SELECT count(DISTINCT name) FROM projects"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total number of gas stations that opened between 2000 and 2005?"}, {"role": "assistant", "content": "SELECT count(*) FROM gas_station WHERE open_year BETWEEN 2000 AND 2005"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name and cost of all procedures sorted by the cost from the highest to the lowest."}, {"role": "assistant", "content": "SELECT name ,  cost FROM procedures ORDER BY cost DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find out the top 10 customers by total number of orders. List customers' first and last name and the number of total orders."}, {"role": "assistant", "content": "SELECT T1.first_name ,  T1.last_name ,  COUNT(*) FROM customers AS T1 JOIN invoices AS T2 ON T2.customer_id  =  T1.id GROUP BY T1.id ORDER BY COUNT(*) DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many camera lenses are not used in taking any photos?"}, {"role": "assistant", "content": "SELECT count(*) FROM camera_lens WHERE id NOT IN ( SELECT camera_lens_id FROM photos )"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all genres in alphabetical order, combined with its ratings?"}, {"role": "assistant", "content": "SELECT g_name ,  rating FROM genre ORDER BY g_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the official names of cities that have hosted more than one competition?"}, {"role": "assistant", "content": "SELECT T1.Official_Name FROM city AS T1 JOIN farm_competition AS T2 ON T1.City_ID  =  T2.Host_city_ID GROUP BY T2.Host_city_ID HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of artists who have had volumes."}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT Artist_ID) FROM volume"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find names of all students who took some course and got A or C."}, {"role": "assistant", "content": "SELECT T1.stu_fname ,  T1.stu_lname FROM student AS T1 JOIN enroll AS T2 ON T1.stu_num  =  T2.stu_num WHERE T2.enroll_grade  =  'C' OR T2.enroll_grade  =  'A'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id of the most recent order?"}, {"role": "assistant", "content": "SELECT order_id FROM orders ORDER BY date_order_placed DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "list names of all departments ordered by their names."}, {"role": "assistant", "content": "SELECT dept_name FROM department ORDER BY dept_name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the reviewer id of Daniel Lewis?"}, {"role": "assistant", "content": "SELECT rID FROM Reviewer WHERE name  =  \"Daniel Lewis\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids for transactions that have an amount greater than the average amount of a transaction?"}, {"role": "assistant", "content": "SELECT transaction_id FROM Financial_transactions WHERE transaction_amount  >  (SELECT avg(transaction_amount) FROM Financial_transactions)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all player names who have an overall rating higher than the average."}, {"role": "assistant", "content": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.overall_rating  >  ( SELECT avg(overall_rating) FROM Player_Attributes )"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show different colleges along with the number of authors of submission from each college."}, {"role": "assistant", "content": "SELECT College ,  COUNT(*) FROM submission GROUP BY College"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the address and staff number of the shops that do not have any happy hour."}, {"role": "assistant", "content": "SELECT address ,  num_of_staff FROM shop WHERE shop_id NOT IN (SELECT shop_id FROM happy_hour)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and account balance of the customers who have loans with a total amount of more than 5000."}, {"role": "assistant", "content": "SELECT T1.cust_name ,  T1.acc_type FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name HAVING sum(T2.amount)  >  5000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each sex, what is the name and sex of the candidate with the oppose rate for their sex?"}, {"role": "assistant", "content": "SELECT t1.name ,  t1.sex ,  min(oppose_rate) FROM people AS t1 JOIN candidate AS t2 ON t1.people_id  =  t2.people_id GROUP BY t1.sex"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the department with the most credits?"}, {"role": "assistant", "content": "SELECT dept_name FROM course GROUP BY dept_name ORDER BY sum(credits) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the average transaction amount, as well as the total amount of all transactions."}, {"role": "assistant", "content": "SELECT avg(transaction_amount) ,  sum(transaction_amount) FROM Financial_transactions"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the denomination more than one school have?"}, {"role": "assistant", "content": "SELECT Denomination FROM school GROUP BY Denomination HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the location and nickname of each school?"}, {"role": "assistant", "content": "SELECT T1.Location ,  T2.Nickname FROM school AS T1 JOIN school_details AS T2 ON T1.School_ID  =  T2.School_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the albums that have more than 10 tracks?"}, {"role": "assistant", "content": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.album_id GROUP BY T1.id HAVING count(T1.id)  >  10;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the headquarter of the company with the largest sales?"}, {"role": "assistant", "content": "SELECT Headquarters FROM company ORDER BY Sales_in_Billion DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name of tracks belongs to genre Rock and whose media type is MPEG audio file."}, {"role": "assistant", "content": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id JOIN media_types AS T3 ON T3.id = T2.media_type_id WHERE T1.name = \"Rock\" AND T3.name = \"MPEG audio file\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of stations that have latitude lower than 37.5?"}, {"role": "assistant", "content": "SELECT name FROM station WHERE lat  <  37.5"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the maximum and minimum market value of companies?"}, {"role": "assistant", "content": "SELECT max(Market_Value_in_Billion) ,  min(Market_Value_in_Billion) FROM company"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the country of origin of the artist who is female and produced a song in Bangla?"}, {"role": "assistant", "content": "SELECT T1.country FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T1.gender  =  \"Female\" AND T2.languages  =  \"bangla\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the last name of the staff whose email address contains \"wrau\"."}, {"role": "assistant", "content": "SELECT last_name FROM staff WHERE email_address LIKE \"%wrau%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of customers who have loans of both Mortgages and Auto."}, {"role": "assistant", "content": "SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Mortgages' INTERSECT SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Auto'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the email addresses and date of births for all customers who have a first name of Carole?"}, {"role": "assistant", "content": "SELECT email_address ,  date_of_birth FROM Customers WHERE first_name = \"Carole\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of organizations whose names contain \"Party\"."}, {"role": "assistant", "content": "SELECT organization_name FROM organizations WHERE organization_name LIKE \"%Party%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show each student's first name and last name."}, {"role": "assistant", "content": "SELECT DISTINCT firstname ,  lastname FROM list"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first names and last names of all the guests?"}, {"role": "assistant", "content": "SELECT guest_first_name ,  guest_last_name FROM Guests"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the total revenue of companies started by founder?"}, {"role": "assistant", "content": "SELECT sum(revenue) ,  founder FROM manufacturers GROUP BY founder"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "From which hometowns did no gymnasts come from?"}, {"role": "assistant", "content": "SELECT DISTINCT Hometown FROM people EXCEPT SELECT DISTINCT T2.Hometown FROM gymnast AS T1 JOIN people AS T2 ON T1.Gymnast_ID  =  T2.People_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average hours across all projects?"}, {"role": "assistant", "content": "SELECT avg(hours) FROM projects"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of all races held in 2017."}, {"role": "assistant", "content": "SELECT name FROM races WHERE YEAR = 2017"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the season, the player, and the name of the country that player belongs to."}, {"role": "assistant", "content": "SELECT T2.Season ,  T2.Player ,  T1.Country_name FROM country AS T1 JOIN match_season AS T2 ON T1.Country_id  =  T2.Country"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the customer who has the largest number of orders?"}, {"role": "assistant", "content": "SELECT T1.customer_name FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.customer_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average amount due for all the payments?"}, {"role": "assistant", "content": "SELECT avg(amount_due) FROM payments"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which organizations are not a parent organization of others? List the organization id."}, {"role": "assistant", "content": "SELECT organization_id FROM organizations EXCEPT SELECT parent_organization_id FROM organizations"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which catalog contents have a product stock number that starts from \"2\"? Show the catalog entry names."}, {"role": "assistant", "content": "SELECT catalog_entry_name FROM catalog_contents WHERE product_stock_number LIKE \"2%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the lot details and investor ids."}, {"role": "assistant", "content": "SELECT lot_details ,  investor_id FROM LOTS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of cities that are in the county with the most police officers?"}, {"role": "assistant", "content": "SELECT name FROM city WHERE county_ID  =  (SELECT county_ID FROM county_public_safety ORDER BY Police_officers DESC LIMIT 1)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the different customers who have taken out a loan, ordered by the total amount that they have taken?"}, {"role": "assistant", "content": "SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id GROUP BY T1.cust_name ORDER BY sum(T2.amount)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the least popular kind of decor?"}, {"role": "assistant", "content": "SELECT T2.decor FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T2.decor ORDER BY count(T2.decor) ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which customer status code has least number of customers?"}, {"role": "assistant", "content": "SELECT customer_status_code FROM Customers GROUP BY customer_status_code ORDER BY count(*) ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different professors are there for the different schools?"}, {"role": "assistant", "content": "SELECT count(*) ,  T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of accounts with a savings balance that is higher than the average savings balance."}, {"role": "assistant", "content": "SELECT count(*) FROM savings WHERE balance  >  (SELECT avg(balance) FROM savings)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which club has the most members majoring in \"600\"?"}, {"role": "assistant", "content": "SELECT t1.clubname FROM club AS t1 JOIN member_of_club AS t2 ON t1.clubid  =  t2.clubid JOIN student AS t3 ON t2.stuid  =  t3.stuid WHERE t3.major  =  \"600\" GROUP BY t1.clubname ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all the rooms that have a price higher than 160 and can accommodate more than 2 people. Report room names and ids."}, {"role": "assistant", "content": "SELECT roomName ,  RoomId FROM Rooms WHERE basePrice  >  160 AND maxOccupancy  >  2;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many sections does each course has?"}, {"role": "assistant", "content": "SELECT count(*) ,  crs_code FROM CLASS GROUP BY crs_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the number of invoices from Chicago, IL."}, {"role": "assistant", "content": "SELECT COUNT(*) FROM invoices WHERE billing_city  =  \"Chicago\" AND billing_state  =  \"IL\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name of students who is older than 20."}, {"role": "assistant", "content": "SELECT fname FROM student WHERE age  >  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "what is the GDP of the city with the largest population."}, {"role": "assistant", "content": "SELECT gdp FROM city ORDER BY Regional_Population DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the maximum and mininum number of stars a rating can receive?"}, {"role": "assistant", "content": "SELECT max(stars) ,  min(stars) FROM Rating"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different software platforms are there for devices?"}, {"role": "assistant", "content": "SELECT count(DISTINCT Software_Platform) FROM device"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the medicine name and trade name which can both interact as 'inhibitor' and 'activitor' with enzymes."}, {"role": "assistant", "content": "SELECT T1.name ,  T1.trade_name FROM medicine AS T1 JOIN medicine_enzyme_interaction AS T2 ON T2.medicine_id  =  T1.id WHERE interaction_type  =  'inhibitor' INTERSECT SELECT T1.name ,  T1.trade_name FROM medicine AS T1 JOIN medicine_enzyme_interaction AS T2 ON T2.medicine_id  =  T1.id WHERE interaction_type  =  'activitor'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average, maximum, and minimum budget for all movies before 2000."}, {"role": "assistant", "content": "SELECT avg(budget_million) ,  max(budget_million) ,  min(budget_million) FROM movie WHERE YEAR  <  2000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the sum of revenue from companies with headquarters in Austin?"}, {"role": "assistant", "content": "SELECT sum(revenue) FROM manufacturers WHERE headquarter  =  'Austin'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count different addresses of each school."}, {"role": "assistant", "content": "SELECT count(DISTINCT dept_address) ,  school_code FROM department GROUP BY school_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different bike ids are there?"}, {"role": "assistant", "content": "SELECT count(DISTINCT bike_id) FROM trip"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and salary of the employee with the id 242518965?"}, {"role": "assistant", "content": "SELECT name ,  salary FROM Employee WHERE eid  =  242518965"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the product ID of the most frequently ordered item on invoices?"}, {"role": "assistant", "content": "SELECT Product_ID FROM INVOICES GROUP BY Product_ID ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all the names of schools with an endowment amount smaller than or equal to 10."}, {"role": "assistant", "content": "SELECT T2.school_name FROM endowment AS T1 JOIN school AS T2 ON T1.school_id  =  T2.school_id GROUP BY T1.school_id HAVING sum(T1.amount)  <=  10"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of all reviewers who did not give 4 stars?"}, {"role": "assistant", "content": "SELECT rID FROM Rating EXCEPT SELECT rID FROM Rating WHERE stars  =  4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the hometowns from which two or more gymnasts are from."}, {"role": "assistant", "content": "SELECT T2.Hometown FROM gymnast AS T1 JOIN people AS T2 ON T1.Gymnast_ID  =  T2.People_ID GROUP BY T2.Hometown HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show different type codes of products and the number of products with each type code."}, {"role": "assistant", "content": "SELECT Product_Type_Code ,  COUNT(*) FROM Products GROUP BY Product_Type_Code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the average horizontal bar points across all gymnasts."}, {"role": "assistant", "content": "SELECT avg(Horizontal_Bar_Points) FROM gymnast"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which players are from Indonesia?"}, {"role": "assistant", "content": "SELECT T2.Player FROM country AS T1 JOIN match_season AS T2 ON T1.Country_id  =  T2.Country WHERE T1.Country_name  =  \"Indonesia\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the characters for actors, ordered by age descending."}, {"role": "assistant", "content": "SELECT Character FROM actor ORDER BY age DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and opening hours of the tourist attractions that can be accessed by bus or walk?"}, {"role": "assistant", "content": "SELECT Name ,  Opening_Hours FROM TOURIST_ATTRACTIONS WHERE How_to_Get_There  =  \"bus\" OR How_to_Get_There  =  \"walk\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the years of film market estimation for the market of Japan, ordered by year descending?"}, {"role": "assistant", "content": "SELECT T1.Year FROM film_market_estimation AS T1 JOIN market AS T2 ON T1.Market_ID  =  T2.Market_ID WHERE T2.Country  =  \"Japan\" ORDER BY T1.Year DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of reviewers who had rated 3 star and 4 star?"}, {"role": "assistant", "content": "SELECT T2.name FROM Rating AS T1 JOIN Reviewer AS T2 ON T1.rID  =  T2.rID WHERE T1.stars  =  3 INTERSECT SELECT T2.name FROM Rating AS T1 JOIN Reviewer AS T2 ON T1.rID  =  T2.rID WHERE T1.stars  =  4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and hours for the project which has the most scientists assigned to it?"}, {"role": "assistant", "content": "SELECT T1.name ,  T1.hours FROM projects AS T1 JOIN assignedto AS T2 ON T1.code  =  T2.project GROUP BY T2.project ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me the name of each club."}, {"role": "assistant", "content": "SELECT clubname FROM club"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the total number of horses on farms in ascending order."}, {"role": "assistant", "content": "SELECT Total_Horses FROM farm ORDER BY Total_Horses ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which programs are never broadcasted in the morning? Give me the names of the programs."}, {"role": "assistant", "content": "SELECT name FROM program EXCEPT SELECT t1.name FROM program AS t1 JOIN broadcast AS t2 ON t1.program_id  =  t2.program_id WHERE t2.Time_of_day  =  \"Morning\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many employees have a first name of Ludie?"}, {"role": "assistant", "content": "SELECT count(*) FROM Staff WHERE first_name = \"Ludie\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of trips that did not end in San Francisco city."}, {"role": "assistant", "content": "SELECT count(*) FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id WHERE T2.city !=  \"San Francisco\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all pilot names in ascending alphabetical order."}, {"role": "assistant", "content": "SELECT Name FROM pilot ORDER BY Name ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the maximum and minimum settlement amount on record?"}, {"role": "assistant", "content": "SELECT max(settlement_amount) ,  min(settlement_amount) FROM settlements"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many invoices were billed from each state?"}, {"role": "assistant", "content": "SELECT billing_state ,  COUNT(*) FROM invoices WHERE billing_country  =  \"USA\" GROUP BY billing_state;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many classes are held in each department?"}, {"role": "assistant", "content": "SELECT count(*) ,  dept_code FROM CLASS AS T1 JOIN course AS T2 ON T1.crs_code  =  T2.crs_code GROUP BY dept_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the top 3 artists with the largest number of songs in the language Bangla?"}, {"role": "assistant", "content": "SELECT T1.artist_name FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.languages  =  \"bangla\" GROUP BY T2.artist_name ORDER BY count(*) DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the last date of the staff leaving the projects?"}, {"role": "assistant", "content": "SELECT date_to FROM Project_Staff ORDER BY date_to DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "find the total percentage share of all channels owned by CCTV."}, {"role": "assistant", "content": "SELECT sum(Share_in_percent) FROM channel WHERE OWNER  =  'CCTV'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first name and last name of the players whose death record is empty?"}, {"role": "assistant", "content": "SELECT name_first ,  name_last FROM player WHERE death_year = '';"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all the document names which contains \"CV\"."}, {"role": "assistant", "content": "SELECT document_name FROM documents WHERE document_name LIKE \"%CV%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the official native languages that contain the string \"English\"."}, {"role": "assistant", "content": "SELECT Official_native_language FROM country WHERE Official_native_language LIKE \"%English%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of climbers and the corresponding names of mountains that they climb?"}, {"role": "assistant", "content": "SELECT T1.Name ,  T2.Name FROM climber AS T1 JOIN mountain AS T2 ON T1.Mountain_ID  =  T2.Mountain_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the shipping agent code of shipping agent UPS?"}, {"role": "assistant", "content": "SELECT shipping_agent_code FROM Ref_Shipping_Agents WHERE shipping_agent_name = \"UPS\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the average, minimum, and maximum ticket prices for exhibitions for all years before 2009."}, {"role": "assistant", "content": "SELECT avg(ticket_price) ,  min(ticket_price) ,  max(ticket_price) FROM exhibition WHERE YEAR  <  2009"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the Char cells, Pixels and Hardware colours for the screen of the phone whose hardware model name is \"LG-P760\"."}, {"role": "assistant", "content": "SELECT T1.Char_cells ,  T1.Pixels ,  T1.Hardware_colours FROM screen_mode AS T1 JOIN phone AS T2 ON T1.Graphics_mode = T2.screen_mode WHERE T2.Hardware_Model_name = \"LG-P760\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which party has two or more records?"}, {"role": "assistant", "content": "SELECT Party FROM party GROUP BY Party HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the types and details for all premises and order by the premise type."}, {"role": "assistant", "content": "SELECT premises_type ,  premise_details FROM premises ORDER BY premises_type"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the average transaction amount for different transaction types."}, {"role": "assistant", "content": "SELECT transaction_type_code ,  avg(amount_of_transaction) FROM TRANSACTIONS GROUP BY transaction_type_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which patients made more than one appointment? Tell me the name and phone number of these patients."}, {"role": "assistant", "content": "SELECT name ,  phone FROM appointment AS T1 JOIN patient AS T2 ON T1.patient  =  T2.ssn GROUP BY T1.patient HAVING count(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many stadiums are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM stadium"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the times used by climbers who climbed mountains in the country of Uganda?"}, {"role": "assistant", "content": "SELECT T1.Time FROM climber AS T1 JOIN mountain AS T2 ON T1.Mountain_ID  =  T2.Mountain_ID WHERE T2.Country  =  \"Uganda\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the policy type the most customers choose."}, {"role": "assistant", "content": "SELECT Policy_Type_Code FROM Customer_Policies GROUP BY Policy_Type_Code ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all the information about election."}, {"role": "assistant", "content": "SELECT * FROM election"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name of accounts whose checking balance is below the average checking balance."}, {"role": "assistant", "content": "SELECT T1.name FROM accounts AS T1 JOIN checking AS T2 ON T1.custid  =  T2.custid WHERE T2.balance  <  (SELECT avg(balance) FROM checking)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name of musicals that do not have actors."}, {"role": "assistant", "content": "SELECT Name FROM musical WHERE Musical_ID NOT IN (SELECT Musical_ID FROM actor)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of schools."}, {"role": "assistant", "content": "SELECT count(*) FROM school"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the name of each party and the corresponding number of delegates from that party."}, {"role": "assistant", "content": "SELECT T2.Party ,  COUNT(*) FROM election AS T1 JOIN party AS T2 ON T1.Party  =  T2.Party_ID GROUP BY T1.Party"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id of the event with the most participants?"}, {"role": "assistant", "content": "SELECT Event_ID FROM Participants_in_Events GROUP BY Event_ID ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the rating of the restaurant Subway?"}, {"role": "assistant", "content": "SELECT Rating FROM Restaurant WHERE ResName = \"Subway\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the average population of all counties."}, {"role": "assistant", "content": "SELECT avg(Population) FROM county"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the addresses of the course authors or tutors whose personal name is \"Cathrine\"."}, {"role": "assistant", "content": "SELECT address_line_1 FROM Course_Authors_and_Tutors WHERE personal_name\t =  \"Cathrine\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all the product names with the color description \"white\"."}, {"role": "assistant", "content": "SELECT t1.product_name FROM products AS t1 JOIN ref_colors AS t2 ON t1.color_code  =  t2.color_code WHERE t2.color_description  =  \"white\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average unit price of tracks that belong to Jazz genre?"}, {"role": "assistant", "content": "SELECT AVG(UnitPrice) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Jazz\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of users that are logged in."}, {"role": "assistant", "content": "SELECT count(*) FROM users WHERE user_login  =  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the visit date and details of the tourist whose detail is 'Vincent'"}, {"role": "assistant", "content": "SELECT T2.Visit_Date ,  T2.Visit_Details FROM VISITORS AS T1 JOIN VISITS AS T2 ON T1.Tourist_ID  =  T2.Tourist_ID WHERE T1.Tourist_Details  =  \"Vincent\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the total enrollments of universities of each affiliation type?"}, {"role": "assistant", "content": "SELECT sum(enrollment) ,  affiliation FROM university GROUP BY affiliation"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Report all advisors that advise more than 2 students."}, {"role": "assistant", "content": "SELECT Advisor FROM STUDENT GROUP BY Advisor HAVING COUNT(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the total account balances for each customer from Utah or Texas?"}, {"role": "assistant", "content": "SELECT sum(acc_bal) FROM customer WHERE state  =  'Utah' OR state  =  'Texas'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Name all the products with next entry ID greater than 8."}, {"role": "assistant", "content": "SELECT catalog_entry_name FROM catalog_contents WHERE next_entry_id  >  8"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the authors of submissions in ascending order of scores."}, {"role": "assistant", "content": "SELECT Author FROM submission ORDER BY Scores ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of regions that were affected by the storm in which the most people died?"}, {"role": "assistant", "content": "SELECT T2.region_name FROM affected_region AS T1 JOIN region AS T2 ON T1.region_id  =  T2.region_id JOIN storm AS T3 ON T1.storm_id  =  T3.storm_id ORDER BY T3.Number_Deaths DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of the climbers, ordered by points descending?"}, {"role": "assistant", "content": "SELECT Name FROM climber ORDER BY Points DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the hardware model name for the phones that have screen mode type \"Text\" or RAM size greater than 32."}, {"role": "assistant", "content": "SELECT T2.Hardware_Model_name FROM chip_model AS T1 JOIN phone AS T2 ON T1.Model_name  =  T2.chip_model JOIN screen_mode AS T3 ON T2.screen_mode = T3.Graphics_mode WHERE T3.Type = \"Text\" OR T1.RAM_MiB  >  32;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of wines that are more expensive then all wines made in the year 2006?"}, {"role": "assistant", "content": "SELECT Name FROM WINE WHERE Price  >  (SELECT max(Price) FROM WINE WHERE YEAR  =  2006)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Retrieve the country that has published the most papers."}, {"role": "assistant", "content": "SELECT t1.country FROM inst AS t1 JOIN authorship AS t2 ON t1.instid  =  t2.instid JOIN papers AS t3 ON t2.paperid  =  t3.paperid GROUP BY t1.country ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first and last name of the president of the club \"Bootup Baltimore\"?"}, {"role": "assistant", "content": "SELECT t3.fname ,  t3.lname FROM club AS t1 JOIN member_of_club AS t2 ON t1.clubid  =  t2.clubid JOIN student AS t3 ON t2.stuid  =  t3.stuid WHERE t1.clubname  =  \"Bootup Baltimore\" AND t2.position  =  \"President\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of trains and locations of railways they are in."}, {"role": "assistant", "content": "SELECT T2.Name ,  T1.Location FROM railway AS T1 JOIN train AS T2 ON T1.Railway_ID  =  T2.Railway_ID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which room has the largest number of reservations?"}, {"role": "assistant", "content": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY count(*) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the most common mill type, and how many are there?"}, {"role": "assistant", "content": "SELECT TYPE ,  count(*) FROM mill GROUP BY TYPE ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show student ids who are on scholarship and have major 600."}, {"role": "assistant", "content": "SELECT StuID FROM Student WHERE major  =  600 INTERSECT SELECT StuID FROM Sportsinfo WHERE onscholarship  =  'Y'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and cities of bank branches that offer loans for business?"}, {"role": "assistant", "content": "SELECT T1.bname ,  T1.city FROM bank AS T1 JOIN loan AS T2 ON T1.branch_id  =  T2.branch_id WHERE T2.loan_type  =  'Business'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "When did the staff member named Janessa Sawayn join the company?"}, {"role": "assistant", "content": "SELECT date_joined_staff FROM Staff WHERE first_name = \"Janessa\" AND last_name = \"Sawayn\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give the average price and case of wines made from Zinfandel grapes in the year 2009."}, {"role": "assistant", "content": "SELECT AVG(Price) ,  AVG(Cases) FROM WINE WHERE YEAR  =  2009 AND Grape  =  \"Zinfandel\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "what is id of students who registered some courses but the least number of courses in these students?"}, {"role": "assistant", "content": "SELECT student_id FROM student_course_registrations GROUP BY student_id ORDER BY count(*) LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all publishers which do not have a book in 1989."}, {"role": "assistant", "content": "SELECT publisher FROM book_club EXCEPT SELECT publisher FROM book_club WHERE YEAR  =  1989"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the description of the club \"Pen and Paper Gaming\"?"}, {"role": "assistant", "content": "SELECT clubdesc FROM club WHERE clubname  =  \"Pen and Paper Gaming\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the descriptions for the aircrafts?"}, {"role": "assistant", "content": "SELECT Description FROM aircraft"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all types of store and number of them."}, {"role": "assistant", "content": "SELECT TYPE ,  count(*) FROM store GROUP BY TYPE"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which team had the least number of attendances in home games in 1980?"}, {"role": "assistant", "content": "SELECT T2.name FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T1.year = 1980 ORDER BY T1.attendance ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many tests have result \"Fail\"?"}, {"role": "assistant", "content": "SELECT count(*) FROM Student_Tests_Taken WHERE test_result  =  \"Fail\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which building has the largest number of company offices? Give me the building name."}, {"role": "assistant", "content": "SELECT T2.name FROM Office_locations AS T1 JOIN buildings AS T2 ON T1.building_id  =  T2.id JOIN Companies AS T3 ON T1.company_id  =  T3.id GROUP BY T1.building_id ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average rating of songs for each language?"}, {"role": "assistant", "content": "SELECT avg(rating) ,  languages FROM song GROUP BY languages"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is maximum, minimum and average amount of outstanding of customer?"}, {"role": "assistant", "content": "SELECT max(amount_outstanding) ,  min(amount_outstanding) ,  avg(amount_outstanding) FROM Customers;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which channels broadcast both in the morning and at night? Give me the channel names."}, {"role": "assistant", "content": "SELECT t1.name FROM channel AS t1 JOIN broadcast AS t2 ON t1.channel_id  =  t2.channel_id WHERE t2.time_of_day  =  'Morning' INTERSECT SELECT t1.name FROM channel AS t1 JOIN broadcast AS t2 ON t1.channel_id  =  t2.channel_id WHERE t2.time_of_day  =  'Night'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find all students taught by OTHA MOYER. Output the first and last names of the students."}, {"role": "assistant", "content": "SELECT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"OTHA\" AND T2.lastname  =  \"MOYER\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many undergraduates are there at San Jose State"}, {"role": "assistant", "content": "SELECT sum(t1.undergraduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Jose State University\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which state has the most customers?"}, {"role": "assistant", "content": "SELECT state FROM customers GROUP BY state ORDER BY count(*) LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who is the president of the club \"Bootup Baltimore\"? Give me the first and last name."}, {"role": "assistant", "content": "SELECT t3.fname ,  t3.lname FROM club AS t1 JOIN member_of_club AS t2 ON t1.clubid  =  t2.clubid JOIN student AS t3 ON t2.stuid  =  t3.stuid WHERE t1.clubname  =  \"Bootup Baltimore\" AND t2.position  =  \"President\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first names and last names of male (sex is M) faculties who live in building NEB."}, {"role": "assistant", "content": "SELECT Fname ,  Lname FROM FACULTY WHERE sex  =  \"M\" AND Building  =  \"NEB\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the bank branch that has lended the largest total amount in loans, specifically to customers with credit scores below 100?"}, {"role": "assistant", "content": "SELECT T2.bname FROM loan AS T1 JOIN bank AS T2 ON T1.branch_id  =  T2.branch_id JOIN customer AS T3 ON T1.cust_id  =  T3.cust_id WHERE T3.credit_score  <  100 GROUP BY T2.bname ORDER BY sum(T1.amount) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of customers who have a loan of more than 3000 in amount?"}, {"role": "assistant", "content": "SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE amount  >  3000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the names and ids of each account, as well as the number of transactions."}, {"role": "assistant", "content": "SELECT T2.account_name ,  T1.account_id ,  count(*) FROM Financial_transactions AS T1 JOIN Accounts AS T2 ON T1.account_id  =  T2.account_id GROUP BY T1.account_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the average and oldest age for students with different sex."}, {"role": "assistant", "content": "SELECT avg(age) ,  max(age) ,  sex FROM student GROUP BY sex"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the phone and email for customer with first name Aniyah and last name Feest?"}, {"role": "assistant", "content": "SELECT customer_phone ,  customer_email FROM Customers WHERE customer_first_name  =  \"Aniyah\" AND customer_last_name  =  \"Feest\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name and city of the airport from most of the routes start?"}, {"role": "assistant", "content": "SELECT T1.name ,  T1.city ,  T2.src_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T2.src_apid ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the details of all sales and purchases?"}, {"role": "assistant", "content": "SELECT sales_details FROM sales UNION SELECT purchase_details FROM purchases"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Tell me the employee id of the head of the department with the least employees."}, {"role": "assistant", "content": "SELECT head FROM department GROUP BY departmentID ORDER BY count(departmentID) LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the movie titles and book titles for all companies in China."}, {"role": "assistant", "content": "SELECT T1.title ,  T3.book_title FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id JOIN book_club AS T3 ON T3.book_club_id  =  T2.book_club_id WHERE T2.incorporated_in  =  'China'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the zip code that has the lowest average mean sea level pressure?"}, {"role": "assistant", "content": "SELECT zip_code FROM weather GROUP BY zip_code ORDER BY avg(mean_sea_level_pressure_inches) LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which themes have had corresponding exhibitions that have had attendance both below 100 and above 500?"}, {"role": "assistant", "content": "SELECT T2.theme FROM exhibition_record AS T1 JOIN exhibition AS T2 ON T1.exhibition_id  =  T2.exhibition_id WHERE T1.attendance  <  100 INTERSECT SELECT T2.theme FROM exhibition_record AS T1 JOIN exhibition AS T2 ON T1.exhibition_id  =  T2.exhibition_id WHERE T1.attendance  >  500"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the draft pick numbers and draft classes for players who play the Defender position?"}, {"role": "assistant", "content": "SELECT Draft_Pick_Number ,  Draft_Class FROM match_season WHERE POSITION  =  \"Defender\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the distinct last names of the students who have class president votes?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_President_VOTE"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the date and venue of each debate?"}, {"role": "assistant", "content": "SELECT Date ,  Venue FROM debate"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of parties that have no members?"}, {"role": "assistant", "content": "SELECT party_name FROM party WHERE party_id NOT IN (SELECT party_id FROM Member)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the gender of the student Linda Smith?"}, {"role": "assistant", "content": "SELECT Sex FROM Student WHERE Fname = \"Linda\" AND Lname = \"Smith\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the purchase time, age and address of each member, and show the results in the order of purchase time."}, {"role": "assistant", "content": "SELECT Time_of_purchase ,  age ,  address FROM member ORDER BY Time_of_purchase"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all the subject names."}, {"role": "assistant", "content": "SELECT subject_name FROM SUBJECTS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all role codes and the number of employees in each role."}, {"role": "assistant", "content": "SELECT role_code ,  count(*) FROM Employees GROUP BY role_code"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which catalog contents has price above 700 dollars? Show their catalog entry names and capacities."}, {"role": "assistant", "content": "SELECT catalog_entry_name ,  capacity FROM Catalog_Contents WHERE price_in_dollars  >  700"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of organization that has the greatest number of contact individuals?"}, {"role": "assistant", "content": "SELECT t1.organization_name FROM organizations AS t1 JOIN organization_contact_individuals AS t2 ON t1.organization_id  =  t2.organization_id GROUP BY t1.organization_name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the average credit score of the customers who have some loan."}, {"role": "assistant", "content": "SELECT avg(credit_score) FROM customer WHERE cust_id IN (SELECT cust_id FROM loan)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the position of players with average number of points scored by players of that position bigger than 20."}, {"role": "assistant", "content": "SELECT POSITION FROM player GROUP BY name HAVING avg(Points)  >=  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which institution has the most papers? Find the name of the institution."}, {"role": "assistant", "content": "SELECT t1.name FROM inst AS t1 JOIN authorship AS t2 ON t1.instid  =  t2.instid JOIN papers AS t3 ON t2.paperid  =  t3.paperid GROUP BY t1.name ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which campus has the most degrees conferred in all times?"}, {"role": "assistant", "content": "SELECT campus FROM degrees GROUP BY campus ORDER BY sum(degrees) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who is the instructor with the highest salary?"}, {"role": "assistant", "content": "SELECT name FROM instructor ORDER BY salary DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which months have more than 2 happy hours?"}, {"role": "assistant", "content": "SELECT MONTH FROM happy_hour GROUP BY MONTH HAVING count(*)  >  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the captain rank that has some captains in both Cutter and Armed schooner classes."}, {"role": "assistant", "content": "SELECT rank FROM captain WHERE CLASS  =  'Cutter' INTERSECT SELECT rank FROM captain WHERE CLASS  =  'Armed schooner'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the names and typical buying prices for all products."}, {"role": "assistant", "content": "SELECT product_name ,  typical_buying_price FROM products"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is maximum and minimum RAM size of phone produced by company named \"Nokia Corporation\"?"}, {"role": "assistant", "content": "SELECT max(T1.RAM_MiB) ,  min(T1.RAM_MiB) FROM chip_model AS T1 JOIN phone AS T2 ON T1.Model_name  =  T2.chip_model WHERE T2.Company_name = \"Nokia Corporation\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are all company names that have a corresponding movie directed in the year 1999?"}, {"role": "assistant", "content": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the first and last names of all drivers who participated in the Australian Grand Prix but not the Chinese Grand Prix?"}, {"role": "assistant", "content": "SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Australian Grand Prix\" EXCEPT SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Chinese Grand Prix\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of companies."}, {"role": "assistant", "content": "SELECT count(*) FROM Companies"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Tell me the booking status code for the apartment with number \"Suite 634\"."}, {"role": "assistant", "content": "SELECT T1.booking_status_code FROM Apartment_Bookings AS T1 JOIN Apartments AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.apt_number  =  \"Suite 634\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the names of wrestlers and the teams in elimination in descending order of days held."}, {"role": "assistant", "content": "SELECT T2.Name ,  T1.Team FROM elimination AS T1 JOIN wrestler AS T2 ON T1.Wrestler_ID  =  T2.Wrestler_ID ORDER BY T2.Days_held DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first name and gender of the student who has allergy to milk but not cat."}, {"role": "assistant", "content": "SELECT fname ,  sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_allergy WHERE Allergy  =  \"Milk\" EXCEPT SELECT StuID FROM Has_allergy WHERE Allergy  =  \"Cat\")"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the maximum and minimum number of cows across all farms."}, {"role": "assistant", "content": "SELECT max(Cows) ,  min(Cows) FROM farm"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the activity that has the most faculty members involved in?"}, {"role": "assistant", "content": "SELECT T1.activity_name FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the claim processing stage that most of the claims are on?"}, {"role": "assistant", "content": "SELECT t2.claim_status_name FROM claims_processing AS t1 JOIN claims_processing_stages AS t2 ON t1.claim_stage_id  =  t2.claim_stage_id GROUP BY t1.claim_stage_id ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which cities have 2 to 4 parks?"}, {"role": "assistant", "content": "SELECT city FROM park GROUP BY city HAVING count(*) BETWEEN 2 AND 4;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many exhibition are there in year 2005 or after?"}, {"role": "assistant", "content": "SELECT count(*) FROM exhibition WHERE YEAR  >=  2005"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the IDs of customers whose name contains \"Diana\"."}, {"role": "assistant", "content": "SELECT customer_id FROM customers WHERE customer_name LIKE \"%Diana%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the number of distinct teams that suffer elimination?"}, {"role": "assistant", "content": "SELECT COUNT (DISTINCT team) FROM elimination"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of people and the number of times they have been on the affirmative side of debates."}, {"role": "assistant", "content": "SELECT T2.Name ,  COUNT(*) FROM debate_people AS T1 JOIN people AS T2 ON T1.Affirmative  =  T2.People_ID GROUP BY T2.Name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the \"active to date\" of the latest contact channel used by \"Tillman Ernser\"?"}, {"role": "assistant", "content": "SELECT max(t2.active_to_date) FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.customer_name  =  \"Tillman Ernser\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many customers have opened an account?"}, {"role": "assistant", "content": "SELECT count(DISTINCT customer_id) FROM Accounts"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many unique labels are there for albums?"}, {"role": "assistant", "content": "SELECT count(DISTINCT label) FROM albums"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "In which year did the least people enter hall of fame?"}, {"role": "assistant", "content": "SELECT yearid FROM hall_of_fame GROUP BY yearid ORDER BY count(*) ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first and last name of the student who played the most sports?"}, {"role": "assistant", "content": "SELECT T2.Fname ,  T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of departments that are either in division AS or in division EN and in Building NEB."}, {"role": "assistant", "content": "SELECT DName FROM DEPARTMENT WHERE Division  =  \"AS\" UNION SELECT DName FROM DEPARTMENT WHERE Division  =  \"EN\" AND Building  =  \"NEB\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the label that has the most albums?"}, {"role": "assistant", "content": "SELECT label FROM albums GROUP BY label ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the department name that is in Building \"Mergenthaler\"."}, {"role": "assistant", "content": "SELECT DName FROM DEPARTMENT WHERE Building  =  \"Mergenthaler\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Give me a list of distinct product ids from orders placed between 1975-01-01 and 1976-01-01?"}, {"role": "assistant", "content": "SELECT DISTINCT T2.product_id FROM orders AS T1 JOIN order_items AS T2 ON T1.order_id = T2.order_id WHERE T1.date_order_placed >= \"1975-01-01\" AND T1.date_order_placed <= \"1976-01-01\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the names of bank branches that have provided a loan to any customer whose credit score is below 100."}, {"role": "assistant", "content": "SELECT T2.bname FROM loan AS T1 JOIN bank AS T2 ON T1.branch_id  =  T2.branch_id JOIN customer AS T3 ON T1.cust_id  =  T3.cust_id WHERE T3.credit_score  <  100"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of journalists and the names of the events they reported in ascending order"}, {"role": "assistant", "content": "SELECT T3.Name ,  T2.Name FROM news_report AS T1 JOIN event AS T2 ON T1.Event_ID  =  T2.Event_ID JOIN journalist AS T3 ON T1.journalist_ID  =  T3.journalist_ID ORDER BY T2.Event_Attendance ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many male (sex is M) students have class senator votes in the fall election cycle?"}, {"role": "assistant", "content": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.Sex  =  \"M\" AND T2.Election_Cycle  =  \"Fall\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the ids of the employees who does not work in those departments where some employees works whose manager id within the range 100 and 200."}, {"role": "assistant", "content": "SELECT * FROM employees WHERE department_id NOT IN (SELECT department_id FROM departments WHERE manager_id BETWEEN 100 AND 200)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the wifi and screen mode type of the hardware model named \"LG-P760\"?"}, {"role": "assistant", "content": "SELECT T1.WiFi , T3.Type FROM chip_model AS T1 JOIN phone AS T2 ON T1.Model_name  =  T2.chip_model JOIN screen_mode AS T3 ON T2.screen_mode = T3.Graphics_mode WHERE T2.Hardware_Model_name = \"LG-P760\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the ids of the problems which are reported after 1978-06-26?"}, {"role": "assistant", "content": "SELECT problem_id FROM problems WHERE date_problem_reported > \"1978-06-26\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the average score and average staff number of all shops?"}, {"role": "assistant", "content": "SELECT avg(num_of_staff) ,  avg(score) FROM shop"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many different jobs are listed?"}, {"role": "assistant", "content": "SELECT count(DISTINCT job) FROM Person"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of shops that have more than a single kind of device in stock?"}, {"role": "assistant", "content": "SELECT T2.Shop_Name FROM stock AS T1 JOIN shop AS T2 ON T1.Shop_ID  =  T2.Shop_ID GROUP BY T1.Shop_ID HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the type description of the organization whose detail is listed as 'quo'?"}, {"role": "assistant", "content": "SELECT T1.organisation_type_description FROM organisation_Types AS T1 JOIN Organisations AS T2 ON T1.organisation_type  =  T2.organisation_type WHERE T2.organisation_details  =  'quo'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who directed Avatar?"}, {"role": "assistant", "content": "SELECT director FROM Movie WHERE title  = 'Avatar'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the customer that has purchased the most items?"}, {"role": "assistant", "content": "SELECT t1.customer_name FROM customers AS t1 JOIN customer_orders AS t2 ON t1.customer_id  =  t2.customer_id JOIN order_items AS t3 ON t2.order_id  =  t3.order_id GROUP BY t1.customer_name ORDER BY sum(t3.order_quantity) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the service id and details for the events."}, {"role": "assistant", "content": "SELECT service_id ,  event_details FROM EVENTS"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For grants with both documents described as 'Regular' and documents described as 'Initial Application', list its start date."}, {"role": "assistant", "content": "SELECT T1.grant_start_date FROM Grants AS T1 JOIN Documents AS T2 ON T1.grant_id  =  T2.grant_id JOIN Document_Types AS T3 ON T2.document_type_code  =  T3.document_type_code WHERE T3.document_description  =  'Regular' INTERSECT SELECT T1.grant_start_date FROM Grants AS T1 JOIN Documents AS T2 ON T1.grant_id  =  T2.grant_id JOIN Document_Types AS T3 ON T2.document_type_code  =  T3.document_type_code WHERE T3.document_description  =  'Initial Application'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who has a friend that is from new york city?"}, {"role": "assistant", "content": "SELECT T2.name FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T1.city  =  'new york city'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id of the reviewer named Daniel Lewis?"}, {"role": "assistant", "content": "SELECT rID FROM Reviewer WHERE name  =  \"Daniel Lewis\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many artists are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM artist"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many technicians are there?"}, {"role": "assistant", "content": "SELECT count(*) FROM technician"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Who are the ministers and what parties do they belong to, listed descending by the times they took office?"}, {"role": "assistant", "content": "SELECT minister ,  party_name FROM party ORDER BY took_office DESC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of classrooms in Lamberton."}, {"role": "assistant", "content": "SELECT count(*) FROM classroom WHERE building  =  'Lamberton'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Tell me the first and last name of the student who has the most activities."}, {"role": "assistant", "content": "SELECT T1.fname ,  T1.lname FROM Student AS T1 JOIN Participates_in AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of courses."}, {"role": "assistant", "content": "SELECT count(*) FROM COURSE"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many students exist?"}, {"role": "assistant", "content": "SELECT count(*) FROM student"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the code of the course which the student whose last name is Smithson took?"}, {"role": "assistant", "content": "SELECT T1.crs_code FROM CLASS AS T1 JOIN enroll AS T2 ON T1.class_code  =  T2.class_code JOIN student AS T3 ON T3.stu_num  =  T2.stu_num WHERE T3.stu_lname  =  'Smithson'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names and genders of all artists who released songs in the month of March?"}, {"role": "assistant", "content": "SELECT T1.artist_name ,  T1.gender FROM artist AS T1 JOIN song AS T2 ON T1.artist_name  =  T2.artist_name WHERE T2.releasedate LIKE \"%Mar%\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which friend of Zach has the longest-lasting friendship?"}, {"role": "assistant", "content": "SELECT friend FROM PersonFriend WHERE name =  'Zach' AND YEAR  =  (SELECT max(YEAR) FROM PersonFriend WHERE name =  'Zach')"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the last names of customers without invoice totals exceeding 20?"}, {"role": "assistant", "content": "SELECT LastName FROM CUSTOMER EXCEPT SELECT T1.LastName FROM CUSTOMER AS T1 JOIN Invoice AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T2.total  >  20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the invoice dates for customers with the first name Astrid and the last name Gruber?"}, {"role": "assistant", "content": "SELECT T2.InvoiceDate FROM CUSTOMER AS T1 JOIN INVOICE AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T1.FirstName  =  \"Astrid\" AND LastName  =  \"Gruber\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the id and star rating of each hotel, ordered by its price from low to high."}, {"role": "assistant", "content": "SELECT hotel_id ,  star_rating_code FROM HOTELS ORDER BY price_range ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average and maximum number of hours students who made the team practiced?"}, {"role": "assistant", "content": "SELECT avg(T1.HS) ,  max(T1.HS) FROM player AS T1 JOIN tryout AS T2 ON T1.pID  =  T2.pID WHERE T2.decision  =  'yes'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the average enrollment of universities founded before 1850."}, {"role": "assistant", "content": "SELECT avg(enrollment) FROM university WHERE founded  <  1850"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names, headquarters and founders of the company with the highest revenue?"}, {"role": "assistant", "content": "SELECT name ,  headquarter ,  founder FROM manufacturers ORDER BY revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the names of people, ordered alphabetically."}, {"role": "assistant", "content": "SELECT Name FROM People ORDER BY Name ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the name and city of the airport which is the destination of the most number of routes."}, {"role": "assistant", "content": "SELECT T1.name ,  T1.city ,  T2.dst_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid GROUP BY T2.dst_apid ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first and last name of the oldest employee?"}, {"role": "assistant", "content": "SELECT emp_fname ,  emp_lname FROM employee ORDER BY emp_dob LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the maximum enrollment across all schools?"}, {"role": "assistant", "content": "SELECT max(Enrollment) FROM university"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the unit price of the tune \"Fast As a Shark\"?"}, {"role": "assistant", "content": "SELECT unit_price FROM tracks WHERE name = \"Fast As a Shark\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show home city where at least two drivers older than 40 are from."}, {"role": "assistant", "content": "SELECT home_city FROM driver WHERE age  >  40 GROUP BY home_city HAVING count(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List countries that have more than one swimmer."}, {"role": "assistant", "content": "SELECT nationality ,  count(*) FROM swimmer GROUP BY nationality HAVING count(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which university is in Los Angeles county and opened after 1950?"}, {"role": "assistant", "content": "SELECT campus FROM campuses WHERE county  =  \"Los Angeles\" AND YEAR  >  1950"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "get the details of employees who manage a department."}, {"role": "assistant", "content": "SELECT DISTINCT * FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id WHERE T1.employee_id  =  T2.manager_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many events are there for each party?"}, {"role": "assistant", "content": "SELECT T2.party_name ,  count(*) FROM party_events AS T1 JOIN party AS T2 ON T1.party_id  =  T2.party_id GROUP BY T1.party_id"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the id and last name of the driver who participated in the most races after 2010?"}, {"role": "assistant", "content": "SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid WHERE T3.year > 2010 GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the product names whose average product price is below 1000000."}, {"role": "assistant", "content": "SELECT Product_Name FROM PRODUCTS GROUP BY Product_Name HAVING avg(Product_Price)  <  1000000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are full names and salaries of employees working in the city of London?"}, {"role": "assistant", "content": "SELECT first_name ,  last_name ,  salary FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id JOIN  locations AS T3 ON T2.location_id  =  T3.location_id WHERE  T3.city  =  'London'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the patient who has the most recent undergoing treatment?"}, {"role": "assistant", "content": "SELECT patient FROM undergoes ORDER BY dateundergoes LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "For each position, what is the maximum number of  hours for students who spent more than 1000 hours training?"}, {"role": "assistant", "content": "SELECT max(T1.HS) ,  pPos FROM player AS T1 JOIN tryout AS T2 ON T1.pID  =  T2.pID WHERE T1.HS  >  1000 GROUP BY T2.pPos"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which people severed as comptroller most frequently? Give me the name of the person and the frequency count."}, {"role": "assistant", "content": "SELECT Comptroller ,  COUNT(*) FROM party GROUP BY Comptroller ORDER BY COUNT(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of banks that have loaned money to customers with credit scores below 100?"}, {"role": "assistant", "content": "SELECT T2.bname FROM loan AS T1 JOIN bank AS T2 ON T1.branch_id  =  T2.branch_id JOIN customer AS T3 ON T1.cust_id  =  T3.cust_id WHERE T3.credit_score  <  100"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the browser that became compatible with the accelerator 'CProxy' after year 1998 ?"}, {"role": "assistant", "content": "SELECT T1.name FROM browser AS T1 JOIN accelerator_compatible_browser AS T2 ON T1.id  =  T2.browser_id JOIN web_client_accelerator AS T3 ON T2.accelerator_id  =  T3.id WHERE T3.name  =  'CProxy' AND T2.compatible_since_year  >  1998"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show all calendar dates and day Numbers."}, {"role": "assistant", "content": "SELECT calendar_date ,  day_Number FROM Ref_calendar"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different locations of the school with the code BUS?"}, {"role": "assistant", "content": "SELECT count(DISTINCT dept_address) FROM department WHERE school_code  =  'BUS'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different affiliations, and what is the total enrollment of schools founded after 1850 for each enrollment type?"}, {"role": "assistant", "content": "SELECT sum(Enrollment) ,  affiliation FROM university WHERE founded  >  1850 GROUP BY affiliation"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the name of rooms booked by customers whose first name has \"ROY\" in part?"}, {"role": "assistant", "content": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE firstname LIKE '%ROY%'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the name of the tourist attraction that is associated with the photo \"game1\"?"}, {"role": "assistant", "content": "SELECT T2.Name FROM PHOTOS AS T1 JOIN TOURIST_ATTRACTIONS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID WHERE T1.Name  =  \"game1\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "what is the name of the instructor who is in Statistics department and earns the lowest salary?"}, {"role": "assistant", "content": "SELECT name FROM instructor WHERE dept_name  =  'Statistics' ORDER BY salary LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of customers who have taken both Mortgage and Auto loans?"}, {"role": "assistant", "content": "SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Mortgages' INTERSECT SELECT T1.cust_name FROM customer AS T1 JOIN loan AS T2 ON T1.cust_id  =  T2.cust_id WHERE loan_type  =  'Auto'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the name of the party that has at least two records."}, {"role": "assistant", "content": "SELECT Party FROM party GROUP BY Party HAVING COUNT(*)  >=  2"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the description of the product called \"Chocolate\"."}, {"role": "assistant", "content": "SELECT product_description FROM products WHERE product_name  =  \"Chocolate\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the average age for each gender?"}, {"role": "assistant", "content": "SELECT avg(age) ,  gender FROM Person GROUP BY gender"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of all the clubs starting with the oldest?"}, {"role": "assistant", "content": "SELECT name FROM club ORDER BY Start_year ASC"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List all information about courses sorted by credits in the ascending order."}, {"role": "assistant", "content": "SELECT * FROM COURSE ORDER BY Credits"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the \"date became customers\" of the customers whose ID is between 10 and 20."}, {"role": "assistant", "content": "SELECT date_became_customer FROM customers WHERE customer_id BETWEEN 10 AND 20"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many documents have expenses?"}, {"role": "assistant", "content": "SELECT count(*) FROM Documents_with_expenses"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which grade is studying in room 105?"}, {"role": "assistant", "content": "SELECT DISTINCT grade FROM list WHERE classroom  =  105"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What procedures cost less than 5000 and have John Wen as a trained physician?"}, {"role": "assistant", "content": "SELECT name FROM procedures WHERE cost  <  5000 INTERSECT SELECT T3.name FROM physician AS T1 JOIN trained_in AS T2 ON T1.employeeid  =  T2.physician JOIN procedures AS T3 ON T3.code  =  T2.treatment WHERE T1.name  =  \"John Wen\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the chip model and screen mode of the phone with hardware model name \"LG-P760\"?"}, {"role": "assistant", "content": "SELECT chip_model ,  screen_mode FROM phone WHERE Hardware_Model_name = \"LG-P760\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the ids of reviewers who didn't only give 4 star."}, {"role": "assistant", "content": "SELECT rID FROM Rating WHERE stars != 4"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which documents have more than 1 draft copies? List document id and number of draft copies."}, {"role": "assistant", "content": "SELECT document_id , count(*) FROM Draft_Copies GROUP BY document_id HAVING count(*)  >  1;"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the name of all projects that are operated longer than the average working hours of all projects."}, {"role": "assistant", "content": "SELECT name FROM projects WHERE hours  >  (SELECT avg(hours) FROM projects)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "With which kind of payment method were the least number of payments processed?"}, {"role": "assistant", "content": "SELECT Payment_Method_Code FROM Payments GROUP BY Payment_Method_Code ORDER BY count(*) ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the cities corresponding to employees who help customers with the postal code 70174."}, {"role": "assistant", "content": "SELECT T2.City FROM CUSTOMER AS T1 JOIN EMPLOYEE AS T2 ON T1.SupportRepId  =  T2.EmployeeId WHERE T1.PostalCode  =  \"70174\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many campuses are there in Los Angeles county?"}, {"role": "assistant", "content": "SELECT count(*) FROM campuses WHERE county  =  \"Los Angeles\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many schools are there in the department?"}, {"role": "assistant", "content": "SELECT count(DISTINCT school_code) FROM department"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Count the number of chip model that do not have wifi."}, {"role": "assistant", "content": "SELECT count(*) FROM chip_model WHERE wifi  =  'No'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the oldest age among the students?"}, {"role": "assistant", "content": "SELECT max(Age) FROM STUDENT"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the maximum training hours for the students whose training hours is greater than 1000 in different positions?"}, {"role": "assistant", "content": "SELECT max(T1.HS) ,  pPos FROM player AS T1 JOIN tryout AS T2 ON T1.pID  =  T2.pID WHERE T1.HS  >  1000 GROUP BY T2.pPos"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of journalists that have reported more than one event."}, {"role": "assistant", "content": "SELECT T3.Name FROM news_report AS T1 JOIN event AS T2 ON T1.Event_ID  =  T2.Event_ID JOIN journalist AS T3 ON T1.journalist_ID  =  T3.journalist_ID GROUP BY T3.Name HAVING COUNT(*)  >  1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Whare the names, friends, and ages of all people who are older than the average age of a person?"}, {"role": "assistant", "content": "SELECT DISTINCT T2.name ,  T2.friend ,  T1.age FROM Person AS T1 JOIN PersonFriend AS T2 ON T1.name  =  T2.friend WHERE T1.age  >  (SELECT avg(age) FROM person)"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the first names of professors who are not playing Canoeing or Kayaking."}, {"role": "assistant", "content": "SELECT lname FROM faculty WHERE rank  =  'Professor' EXCEPT SELECT DISTINCT T1.lname FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID JOIN activity AS T3 ON T2.actid  =  T2.actid WHERE T3.activity_name  =  'Canoeing' OR T3.activity_name  =  'Kayaking'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the dates of ceremony corresponding to music festivals that had the category \"Best Song\" and result \"Awarded\"."}, {"role": "assistant", "content": "SELECT Date_of_ceremony FROM music_festival WHERE Category  =  \"Best Song\" AND RESULT  =  \"Awarded\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which song has the most vocals?"}, {"role": "assistant", "content": "SELECT title FROM vocals AS T1 JOIN songs AS T2 ON T1.songid  =  T2.songid GROUP BY T1.songid ORDER BY count(*) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which department has the highest average student GPA, and what is the average gpa?"}, {"role": "assistant", "content": "SELECT T2.dept_name ,  avg(T1.stu_gpa) FROM student AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY avg(T1.stu_gpa) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of journalists and the number of events they reported."}, {"role": "assistant", "content": "SELECT T3.Name ,  COUNT(*) FROM news_report AS T1 JOIN event AS T2 ON T1.Event_ID  =  T2.Event_ID JOIN journalist AS T3 ON T1.journalist_ID  =  T3.journalist_ID GROUP BY T3.Name"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Which teachers teach in classroom 110? Give me their first names."}, {"role": "assistant", "content": "SELECT firstname FROM teachers WHERE classroom  =  110"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the result description of the project whose detail is 'sint'?"}, {"role": "assistant", "content": "SELECT T1.outcome_description FROM Research_outcomes AS T1 JOIN Project_outcomes AS T2 ON T1.outcome_code  =  T2.outcome_code JOIN Projects AS T3 ON T2.project_id  =  T3.project_id WHERE T3.project_details  =  'sint'"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What is the first and last name of all employees who live in the city Damianfort?"}, {"role": "assistant", "content": "SELECT T2.first_name ,  T2.last_name FROM Addresses AS T1 JOIN Staff AS T2 ON T1.address_id = T2.staff_address_id WHERE T1.city = \"Damianfort\";"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "How many movies were made before 2000?"}, {"role": "assistant", "content": "SELECT count(*) FROM Movie WHERE YEAR  <  2000"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the names of clubs that have players with position \"Right Wing\"."}, {"role": "assistant", "content": "SELECT T1.name FROM club AS T1 JOIN player AS T2 ON T1.Club_ID  =  T2.Club_ID WHERE T2.Position  =  \"Right Wing\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are all the different first names of the drivers who are in position as standing and won?"}, {"role": "assistant", "content": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Find the number of vocal types used in song \"Le Pop\""}, {"role": "assistant", "content": "SELECT count(*) FROM vocals AS T1 JOIN songs AS T2 ON T1.songid  =  T2.songid WHERE title  =  \"Le Pop\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Show the faculty id of each faculty member, along with the number of students he or she advises."}, {"role": "assistant", "content": "SELECT T1.FacID ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the names of perpetrators whose country is not \"China\"?"}, {"role": "assistant", "content": "SELECT T1.Name FROM people AS T1 JOIN perpetrator AS T2 ON T1.People_ID  =  T2.People_ID WHERE T2.Country != \"China\""}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "What are the different schools and their nicknames, ordered by their founding years?"}, {"role": "assistant", "content": "SELECT school ,  nickname FROM university ORDER BY founded"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "List the position of players and the average number of points of players of each position."}, {"role": "assistant", "content": "SELECT POSITION ,  avg(Points) FROM player GROUP BY POSITION"}]}
{"messages": [{"role": "system", "content": "You are a senior data engineer at Microsoft, responsible for constructing valid, intelligent SQL queries, given the user input."}, {"role": "user", "content": "Return the first names of the 5 staff members who have handled the most complaints."}, {"role": "assistant", "content": "SELECT t1.first_name FROM staff AS t1 JOIN complaints AS t2 ON t1.staff_id  =  t2.staff_id GROUP BY t2.staff_id ORDER BY count(*) LIMIT 5"}]}
